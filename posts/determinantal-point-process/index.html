<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Determinantal Point Process | Tai's Blog</title><meta name=keywords content="ML"><meta name=description content="åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šé¢ä¸´ä¸€ä¸ªé—®é¢˜ï¼šç»™å®šä¸€ä¸ªé›†åˆ$\mathbf{S}$ï¼Œä»ä¸­å¯»æ‰¾$k$ä¸ªæ ·æœ¬æ„æˆå­é›†$\mathbf{V}$ï¼Œå°½é‡ä½¿å¾—å­"><meta name=author content><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="eAKh7zszsOtNde1wyq_sUo95ZPH4zTTJhR-_ol4VWDs"><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.js onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=http://yunpengtai.top/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://yunpengtai.top/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://yunpengtai.top/favicon-32x32.png><link rel=apple-touch-icon href=http://yunpengtai.top/apple-touch-icon.png><link rel=mask-icon href=http://yunpengtai.top/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script>MathJax={loader:{load:["[tex]/boldsymbol"]},tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0,tags:"all",packages:{"[+]":["boldsymbol"]}}}</script><script src=https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml-full.js integrity="sha256-kbAFUDxdHwlYv01zraGjvjNZayxKtdoiJ38bDTFJtaQ=" crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y3CX2RWEDY"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Y3CX2RWEDY",{anonymize_ip:!1})}</script><meta property="og:title" content="Determinantal Point Process"><meta property="og:description" content="åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šé¢ä¸´ä¸€ä¸ªé—®é¢˜ï¼šç»™å®šä¸€ä¸ªé›†åˆ$\mathbf{S}$ï¼Œä»ä¸­å¯»æ‰¾$k$ä¸ªæ ·æœ¬æ„æˆå­é›†$\mathbf{V}$ï¼Œå°½é‡ä½¿å¾—å­"><meta property="og:type" content="article"><meta property="og:url" content="http://yunpengtai.top/posts/determinantal-point-process/"><meta property="og:image" content="http://yunpengtai.top/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-04-21T15:20:00+08:00"><meta property="article:modified_time" content="2023-04-21T15:20:00+08:00"><meta property="og:site_name" content="Tai's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://yunpengtai.top/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Determinantal Point Process"><meta name=twitter:description content="åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šé¢ä¸´ä¸€ä¸ªé—®é¢˜ï¼šç»™å®šä¸€ä¸ªé›†åˆ$\mathbf{S}$ï¼Œä»ä¸­å¯»æ‰¾$k$ä¸ªæ ·æœ¬æ„æˆå­é›†$\mathbf{V}$ï¼Œå°½é‡ä½¿å¾—å­"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"http://yunpengtai.top/posts/"},{"@type":"ListItem","position":3,"name":"Determinantal Point Process","item":"http://yunpengtai.top/posts/determinantal-point-process/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Determinantal Point Process","name":"Determinantal Point Process","description":"åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šé¢ä¸´ä¸€ä¸ªé—®é¢˜ï¼šç»™å®šä¸€ä¸ªé›†åˆ$\\mathbf{S}$ï¼Œä»ä¸­å¯»æ‰¾$k$ä¸ªæ ·æœ¬æ„æˆå­é›†$\\mathbf{V}$ï¼Œå°½é‡ä½¿å¾—å­","keywords":["ML"],"articleBody":"åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šé¢ä¸´ä¸€ä¸ªé—®é¢˜ï¼šç»™å®šä¸€ä¸ªé›†åˆ$\\mathbf{S}$ï¼Œä»ä¸­å¯»æ‰¾$k$ä¸ªæ ·æœ¬æ„æˆå­é›†$\\mathbf{V}$ï¼Œå°½é‡ä½¿å¾—å­é›†çš„è´¨é‡é«˜åŒæ—¶å¤šæ ·æ€§å¥½ã€‚æ¯”å¦‚åœ¨æ¨èç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å°±å¸Œæœ›ç»™ç”¨æˆ·æ¨èçš„ä¸œè¥¿å°½å¯èƒ½çš„æœ‰è´¨é‡ï¼ŒåŒæ—¶å…·æœ‰å·®å¼‚æ€§ã€‚\nè€Œä½¿å¾—é‡‡æ ·çš„å­é›†å°½å¯èƒ½å…·å¤‡å¤šæ ·æ€§ä¾¿æ˜¯è¡Œåˆ—å¼ç‚¹è¿‡ç¨‹ï¼ˆDeterminantal Point Processï¼‰å¤§å±•èº«æ‰‹çš„åœ°æ–¹ï¼Œä¿—ç§° DPP\nè¾¹ç¼˜åˆ†å¸ƒ é¦–å…ˆå¼•å…¥ DPP çš„è¾¹ç¼˜åˆ†å¸ƒå®šä¹‰ï¼Œå½“æˆ‘ä»¬æŸæ¬¡é‡‡æ ·å‡ºå­é›†$\\mathbf{A}$ï¼Œã€ŒåŒ…æ‹¬ã€$\\mathbf{V} = [\\boldsymbol{v_{1}},\\boldsymbol{v_{2}},\\dots,\\boldsymbol{v_{k}}] \\in \\mathbb{R}^{{d \\times k}}$çš„æ¦‚ç‡ï¼š\n$$ P(\\mathbf{V} \\subseteq \\mathbf{A}) = \\det(\\mathbf{K_{V}}) $$\n$\\mathbf{K}$æ˜¯æ ¸çŸ©é˜µï¼ˆKernel Matrixï¼‰ï¼Œå³ï¼š\n$$ \\mathbf{K}_{ij} = k(\\boldsymbol{v_{i}}, \\boldsymbol{v_{j}}) $$\n$\\mathbf{K_{V}}$æ˜¯ç”±$\\mathbf{V}$ä¸­å…ƒç´ æ„æˆçš„å­çŸ©é˜µï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå‡å¦‚$\\mathbf{V}=\\{ 1,2 \\}$ï¼Œé‚£ä¹ˆï¼š\n$$ P(\\mathbf{V} \\subseteq \\mathbf{A}) = \\det(\\mathbf{K_{V}}) = \\left|\\begin{array}{cc} \\mathbf{K}_{11} \u0026 \\mathbf{K}_{12} \\\\ \\mathbf{K}_{21} \u0026 \\mathbf{K}_{22} \\end{array}\\right| = \\mathbf{K}_{11}\\mathbf{K}_{22} - \\mathbf{K}_{12}^{2} $$\nå½“$\\mathbf{K}_{12}$è¶Šå¤§ï¼Œåˆ™$\\{ 1,2 \\}$åŒæ—¶å‡ºç°åœ¨$\\mathbf{V}$çš„æ¦‚ç‡å°±è¶Šå°ï¼Œä»è¿™ä¸ªè§’åº¦æƒ³ï¼Œæ ¸å‡½æ•°åº”è¯¥æ˜¯å‘ˆç°å‡ºæŸç§ç›¸ä¼¼æ€§\nä»æ­£å®šæ€§å‡ºå‘ï¼Œä¸¥æ ¼çš„å®šä¹‰å¦‚ä¸‹æ˜¯ï¼š$\\mathbf{0}\\preceq\\mathbf{K} \\preceq \\mathbf{I}$\nä¸¾ä¸ªä¾‹å­ï¼š\n$$ \\mathbf{K} = \\begin{bmatrix} 1 \u0026 -0.3 \\\\ -0.3 \u0026 1 \\end{bmatrix} $$\nå…¶ç‰¹å¾å€¼ä¸º$0.7, -1.3$ï¼Œä¸æ»¡è¶³$\\mathbf{K}-\\mathbf{0} \\succeq \\mathbf{0}$ï¼Œå³ä¸æ˜¯åŠæ­£å®šçŸ©é˜µ\nL-Ensemble ç„¶è€Œï¼Œä¸Šé¢è¾¹ç¼˜å®šä¹‰åªæ˜¯å‘Šè¯‰æˆ‘ä»¬é‡‡æ ·æ—¶ï¼ŒæŸä¸ªå­é›†è¢«ã€ŒåŒ…æ‹¬ã€çš„æ¦‚ç‡ï¼Œå¹¶éå°±æ˜¯è¿™ä¸ªå­é›†ï¼Œè€Œè¿™ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡ L-Ensemble å»è§£\n$$ P(\\mathbf{V}=\\mathbf{A}) \\propto \\det(\\mathbf{L}) $$\nè¿™é‡Œçš„$\\mathbf{L}$çœç•¥äº†ä¸‹æ ‡ï¼Œè·Ÿä¸Šé¢çš„$\\mathbf{K}$ä¸€æ ·ï¼Œæ˜¯è·Ÿ$\\mathbf{V}$å…ƒç´ ç›¸å…³çš„å­çŸ©é˜µã€‚$\\mathbf{L}$çŸ©é˜µçš„æ ¸å‡½æ•°æ˜¯å†…ç§¯æ˜¯$\\boldsymbol{v_{i}^{\\top}\\boldsymbol{v_{j}}}$ï¼Œ$\\mathbf{V} = [\\boldsymbol{v_{1}},\\boldsymbol{v_{2}},\\dots,\\boldsymbol{v_{k}}] \\in \\mathbb{R}^{{d \\times k}}$\n$$ \\mathbf{L} = \\mathbf{V}^{\\top}\\mathbf{V} = \\begin{bmatrix} \\langle \\boldsymbol{v_{1}}, \\boldsymbol{v_{1}} \\rangle \u0026 \\langle \\boldsymbol{v_{1}},\\boldsymbol{v_{2}} \\rangle \u0026 \\dots \u0026 \\langle \\boldsymbol{v_{1}}, \\boldsymbol{v_{k}} \\rangle \\\\ \\langle \\boldsymbol{v_{2}},\\boldsymbol{v_{1}} \\rangle \u0026 \\langle \\boldsymbol{v_{2}},\\boldsymbol{v_{2}} \\rangle \u0026 \\dots \u0026 \\langle \\boldsymbol{v_{2}},\\boldsymbol{v_{k}} \\rangle \\\\ \\vdots \u0026 \\vdots \u0026 \\ddots \u0026 \\vdots \\\\ \\langle \\boldsymbol{v_{k}},\\boldsymbol{v_{1}} \\rangle \u0026 \\langle \\boldsymbol{v_{k}},\\boldsymbol{v_{2}} \\rangle \u0026 \\dots \u0026 \\langle \\boldsymbol{v_{k}},\\boldsymbol{v_{k}} \\rangle \\end{bmatrix} $$\næ³¨æ„ï¼Œè¿™é‡ŒæŒ‡çš„ä¸æ˜¯æ¦‚ç‡ï¼Œè€Œæ˜¯è¯´æ¦‚ç‡ã€Œæ­£æ¯”äºã€$\\mathbf{L}$çŸ©é˜µçš„è¡Œåˆ—å¼ï¼Œé‚£ä¹ˆå¦‚ä½•è®¡ç®—æ¦‚ç‡å‘¢ï¼Ÿä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¾—è®¡ç®—ä¸€ä¸ªå½’ä¸€åŒ–å¸¸æ•°ï¼ˆnormalization constantï¼‰ï¼Œå¯ä»¥ç±»æ¯”æŠ›ç¡¬å¸ï¼Œæˆ‘ä»¬å¾—å»æ±‚æ€»çš„æŠ›èµ·æ¬¡æ•°ï¼Œé™¤ä»¥å®ƒæ‰èƒ½å¾—åˆ°æ¦‚ç‡\nå¼•å…¥ä¸‹è¿°å®šç†ï¼š\n$$ \\sum_{\\mathbf{A}\\subseteq \\mathbf{V} \\subseteq \\mathbf{S}} \\det(\\mathbf{L}) = \\det(\\mathbf{L} + \\mathbf{I_{\\bar{A}}}) $$\nå…¶ä¸­$\\mathbf{I_{\\bar{A}}}$æ˜¯å°†å•ä½çŸ©é˜µä¸­ä¸$\\mathbf{A}$ç›¸å…³å…ƒç´ å…¨éƒ¨ç½®é›¶ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå½“$\\mathbf{S} = \\{ 1,2,3 \\}, \\mathbf{A}={1,2}$æ—¶ï¼š\n$$ \\mathbf{I_{\\bar{A}}} = \\begin{bmatrix} 0 \u0026 0 \u0026 0 \\\\ 0 \u0026 0 \u0026 0 \\\\ 0 \u0026 0 \u0026 1 \\end{bmatrix} $$\né‚£ä¹ˆå¦‚ä½•æ±‚å½’ä¸€åŒ–å¸¸æ•°å‘¢ï¼Œå³å°†$\\mathbf{A}=\\emptyset$ï¼Œå½“$\\mathbf{A}$ä¸ºç©ºé›†æ—¶ï¼Œä¾¿åŒ…æ‹¬äº†æ‰€æœ‰çš„æƒ…å†µï¼Œå³ï¼š\n$$ P(\\mathbf{V}=\\mathbf{A}) = \\frac{\\det(\\mathbf{L})}{\\det(\\mathbf{L}+\\mathbf{I})} $$\nå¦å¤–ï¼ŒL-Emsemble çš„$\\mathbf{K}, \\mathbf{L}$å¯¹åº”å…³ç³»å¦‚ä¸‹ï¼š\n$$ \\begin{align} \\mathbf{K} \u0026 = \\mathbf{L}(\\mathbf{L} + \\mathbf{I})^{-1} \\\\ \\mathbf{L} \u0026 = \\mathbf{K}(\\mathbf{I}-\\mathbf{K})^{-1} \\end{align} $$\nç›´è§‚è§£é‡Š é‚£ä¹ˆï¼Œè¡Œåˆ—å¼ä¸å¤šæ ·æ€§çš„ç›´è§‚è§£é‡Šæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ\nå¤šæ ·æ€§å’Œç›¸ä¼¼æ€§çš„æ„æ€æ­£å¥½ç›¸åï¼Œé€šå¸¸æˆ‘ä»¬ä¼šå®šä¹‰ç›¸ä¼¼æ€§ä¸ºä¸¤ä¸ªå‘é‡ä¹‹é—´åšç‚¹ç§¯ï¼Œå³ä¸º$\\boldsymbol{v_{1}}^{\\top}\\boldsymbol{v_{2}}$ï¼Œç›´è§‚ä¸Šçœ‹ï¼Œä¸¤å‘é‡å¤¹è§’çš„ä½™å¼¦å€¼$\\cos \\theta$ è¶Šå¤§ï¼Œç›¸ä¼¼æ€§è¶Šé«˜ï¼Œåè¿‡æ¥çœ‹ï¼Œå½“$\\cos \\theta$æœ€å°å³ä¸ºä¸¤è€…ç›¸ä¼¼æ€§æœ€å·®ï¼Œå¤šæ ·æ€§æœ€å¥½ã€‚æ˜¾ç„¶ï¼Œå½“ä¸¤å‘é‡æ­£äº¤æ—¶å¤šæ ·æ€§æœ€å¥½ã€‚\né‚£ä¹ˆï¼Œå¯¹äºä¸€ä¸ªå­é›†$\\mathbf{V} = [\\boldsymbol{v_{1}},\\boldsymbol{v_{2}},\\dots,\\boldsymbol{v_{k}}] \\in \\mathbb{R}^{{d \\times k}}$è€Œè¨€ï¼Œè¯¥å¦‚ä½•å®šä¹‰å®ƒçš„å¤šæ ·æ€§å‘¢ï¼Ÿä¸éš¾æƒ³å‡ºï¼Œå¯ä»¥é€šè¿‡çº¿æ€§æ— å…³å‘é‡çš„æ•°é‡æ¥å®šä¹‰ï¼Œè‹¥ä¸¤ä¸¤éƒ½äº’ä¸çº¿æ€§ç›¸å…³ï¼Œæ­¤æ—¶çš„å­é›†çš„å¤šæ ·æ€§æ˜¯æœ€å¥½çš„ã€‚ç›´è§‚ä¸Šå¯ä»¥è½¬æ¢ä¸ºæ„æˆçš„è¶…å¹³è¡Œä½“çš„ä½“ç§¯ï¼Œä¸‹æ–¹ä¸º$k=2,3$æ—¶çš„ç¤ºæ„å›¾\nå›¾æºè‡ªç‹æ ‘æ£®è€å¸ˆçš„è¯¾ç¨‹\nä¸ºä»€ä¹ˆå‘¢ï¼Ÿå¯ä»¥æ‹¿å¹³è¡Œå…­é¢ä½“ä¸ºä¾‹ï¼Œè‹¥å…¶ä¸­ä¸€ä¸ªå‘é‡ä¸å…¶ä»–å‘é‡çº¿æ€§ç›¸å…³ï¼Œé‚£ä¹ˆåˆ™ä¼šåç¼©æˆä¸€ä¸ªå¹³é¢ï¼Œæ„ä¸æˆå¹³è¡Œå…­é¢ä½“\nå›¾æºè‡ª 3BlueBrown å¯¹äºè¡Œåˆ—å¼çš„ä»‹ç»\nåªæœ‰å½“æ‰€æœ‰å‘é‡ä¸¤ä¸¤éƒ½çº¿æ€§æ— å…³æ—¶ï¼Œæ„æˆçš„è¶…å¹³è¡Œä½“ä½“ç§¯æœ€å¤§ï¼Œå³å¤šæ ·æ€§æœ€å¥½\nè€Œè¡Œåˆ—å¼å¯ä»¥è¡¨ç¤ºä½“ç§¯ï¼Œä¸‹å¼ä¸­$\\text{vol}$ä»£è¡¨ä½“ç§¯ï¼ˆvolumeï¼‰ï¼Œæ­¤æ—¶$k=d$ï¼Œ$\\mathbf{V}$ä¸ºæ–¹é˜µ\n$$ \\det(\\mathbf{V})= \\text{vol}(\\mathcal{P}(\\boldsymbol{v_{1}}, \\boldsymbol{v_{2}}, \\dots, \\boldsymbol{v_{k}})) $$\nä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¡Œåˆ—å¼çš„å¤§å°æ¥å®šä¹‰å¤šæ ·æ€§\né‚£ä¹ˆï¼Œ$\\mathbf{L}$çš„è¡Œåˆ—å¼æ˜¯å¦ä¹Ÿè·Ÿä½“ç§¯æœ‰å…³å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼š\n$$ \\det(\\mathbf{L}) = \\text{vol}\\bigg(\\mathcal{P}(\\boldsymbol{v_{1}}, \\boldsymbol{v_{2}}, \\dots,\\boldsymbol{v_{k}})\\bigg)^{2} $$\næ¥ä¸‹æ¥è¯æ˜è¿™ä¸€ç»“è®ºï¼š\nç”±äº$k \\leq d$ï¼Œå› ä¸º$d$ç»´ç©ºé—´è‡³å¤šå­˜åœ¨$d$ä¸ªä¸¤ä¸¤çº¿æ€§æ— å…³çš„å‘é‡ï¼Œé‚£ä¹ˆè‚¯å®šå­˜åœ¨ä¸€ä¸ª$k$ç»´å­ç©ºé—´$\\mathcal{H}$ï¼Œå­˜åœ¨æ­£äº¤çŸ©é˜µ$\\mathbf{R} \\in \\mathbb{R}^{d \\times d}$ï¼Œå¯¹å‘é‡$\\boldsymbol{v_{1}}, \\boldsymbol{v_{2}}, \\dots, \\boldsymbol{v_{k}}$è¿›è¡Œæ—‹è½¬ï¼Œä½¿å¾—$\\mathbf{R}\\boldsymbol{v_{1}}, \\mathbf{R}\\boldsymbol{v_{2}}, \\dots, \\mathbf{R}\\boldsymbol{v_{k}}$éƒ½è½åœ¨å­ç©ºé—´$\\mathcal{H}$ä¸Šã€‚ä¸å¦¨è®¾$\\mathcal{H}$çš„åŸºåº•æ˜¯å‰$k$ä¸ªæ ‡å‡†æ­£äº¤åŸºï¼Œé‚£ä¹ˆï¼š\n$$ \\mathbf{R}\\boldsymbol{v_{i}} = \\begin{bmatrix} \\boldsymbol{u_{i}} \\\\ \\mathbf{0} \\end{bmatrix} $$\n$\\boldsymbol{u_{i}} \\in \\mathbb{R}^{k}$ï¼Œ$\\mathbf{0}$ä¸€å…±æœ‰$d-k$ä¸ªï¼Œå› ä¸ºç”¨$\\mathcal{H}$çš„åŸºåº•å‘é‡è¡¨ç¤ºï¼Œåé¢åªèƒ½ä¸º$0$ï¼Œå°†$\\boldsymbol{u_{1}}, \\boldsymbol{u_{2}},\\dots, \\boldsymbol{u_{k}}$å½“ä½œ$\\mathbf{U}$çš„åˆ—ï¼Œå°±æœ‰ï¼š\n$$ \\mathbf{RV} = \\begin{bmatrix} \\mathbf{U} \\\\ \\mathbf{0} \\end{bmatrix}, \\mathbf{U} \\in \\mathbb{R}^{k \\times k} $$\næ˜¾ç„¶ï¼Œ$\\mathcal{P}(\\boldsymbol{u_{1}}, \\dots)$ä¸$\\mathcal{P}([\\boldsymbol{u_{1}};\\boldsymbol{0}],\\dots )$ä¸¤è€…ä½“ç§¯ç›¸ç­‰\n$$ \\text{vol}(\\mathcal{P}(\\boldsymbol{u_{1}}, \\boldsymbol{u_{2}},\\dots, \\boldsymbol{u_{k}})) = \\text{vol}\\bigg(\\mathcal{P}\\bigg(\\begin{bmatrix} \\boldsymbol{u_{1}} \\\\ \\boldsymbol{0} \\end{bmatrix}, \\begin{bmatrix} \\boldsymbol{u_{2}} \\\\ \\boldsymbol{0} \\\\ \\end{bmatrix}, \\dots, \\begin{bmatrix} \\boldsymbol{u_{k}} \\\\ \\boldsymbol{0} \\end{bmatrix}\\bigg)\\bigg) $$\né‚£ä¹ˆï¼š\n$$ \\text{vol}(\\mathcal{P}(\\boldsymbol{u_{1}}, \\boldsymbol{u_{2}}, \\dots, \\boldsymbol{u_{k}})) = \\text{vol}\\bigg(\\mathcal{P}(\\mathbf{R}\\boldsymbol{v_{1}}, \\mathbf{R}\\boldsymbol{v_{2}}, \\dots, \\mathbf{R}\\boldsymbol{v_{k}})\\bigg) $$\nç”±äºå¯¹è¶…å¹³é¢ä½“è¿›è¡Œæ—‹è½¬ä¸æ”¹å˜å…¶ä½“ç§¯ï¼ˆæ³¨æ„ï¼Œè¿™é‡Œæ˜¯æ—‹è½¬è€Œä¸æ˜¯ä¸€èˆ¬çš„çº¿æ€§å˜æ¢ï¼Œä¸€èˆ¬çš„çº¿æ€§å˜æ¢ä¸å…·å¤‡è¯¥æ€§è´¨ï¼‰\n$$ \\text{vol}\\bigg(\\mathcal{P}(\\mathbf{R}\\boldsymbol{v_{1}}, \\mathbf{R}\\boldsymbol{v_{2}}, \\dots, \\mathbf{R}\\boldsymbol{v_{k}})\\bigg) = \\text{vol}\\bigg(\\mathcal{P}(\\boldsymbol{v_{1}}, \\boldsymbol{v_{2}}, \\dots, \\boldsymbol{v_{k}})\\bigg) $$\né‚£ä¹ˆï¼š\n$$ \\text{vol}(\\mathcal{P}(\\boldsymbol{u_{1}}, \\boldsymbol{u_{2}}, \\dots, \\boldsymbol{u_{k}})) =\\text{vol}\\bigg(\\mathcal{P}(\\mathbf{R}\\boldsymbol{v_{1}}, \\mathbf{R}\\boldsymbol{v_{2}}, \\dots, \\mathbf{R}\\boldsymbol{v_{k}})\\bigg) $$\nåˆå› ä¸º$\\mathbf{R}$æ­£äº¤çŸ©é˜µï¼Œå³$\\mathbf{R}^{\\top}\\mathbf{R} = \\mathbf{I}$ï¼Œé‚£ä¹ˆï¼š\n$$ \\mathbf{U}^{\\top}\\mathbf{U} = (\\mathbf{RV})^{\\top}\\mathbf{RV} = \\mathbf{V}^{\\top}(\\mathbf{R}^{\\top}\\mathbf{R)}\\mathbf{V} = \\mathbf{V}^{\\top}\\mathbf{V} $$\næ‰€ä»¥ï¼š\n$$ \\det(\\mathbf{V}^{\\top}\\mathbf{V}) = \\det(\\mathbf{U}^{\\top}\\mathbf{U}) = \\det(\\mathbf{U})^{2} = \\text{vol}\\bigg(\\mathcal{P}(\\boldsymbol{v_{1}}, \\boldsymbol{v_{2}}, \\dots, \\boldsymbol{v_{k}})\\bigg)^{2} $$\nä» L-Emsemble è§’åº¦çœ‹ï¼Œè¢«é‡‡æ ·çš„æ¦‚ç‡æ­£æ¯”äºæ„æˆçš„è¶…å¹³é¢ä½“çš„ä½“ç§¯ï¼Œå³ä¸¤ä¸¤ä¹‹é—´çº¿æ€§æ— å…³æ›´å®¹æ˜“è¢«é‡‡æ ·å‡º\nDemo æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨ä¾‹å­æ¥çœ‹ä¸€ä¸‹æ˜¯å¦ DPP èƒ½å¤Ÿé‡‡æ ·å‡ºæ›´æœ‰å¤šæ ·æ€§çš„å­é›†\nfrom torch import det, eye from transformers import set_seed from transformers import BertModel, BertTokenizer set_seed(42) pretrain_path = \"fabriceyhc/bert-base-uncased-imdb\" model = BertModel.from_pretrained(pretrain_path).cuda() tk = BertTokenizer.from_pretrained(pretrain_path) input_text = [ \"I am happy because the weather is extremely good!\", \"I hate the bad weather\", \"The weather is extremely good!\", ] inputs = tk(input_text, max_length=128, return_tensors=\"pt\", truncation=True, padding=True) inputs = {k: v.cuda() for k, v in inputs.items()} outputs = model(**inputs).pooler_output.T vtv = outputs.T @ outputs group_12 = vtv[:2][:, [0, 1]] I = eye(2).cuda() p_12 = det(group_12) / det(group_12 + I) group_13 = vtv[[0, 2]][:, [0, 2]] p_13 = det(group_13) / det(group_13 + I) print('é‡‡æ ·åˆ°ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªçš„æ¦‚ç‡ï¼š%f'%p_12) print('é‡‡æ ·åˆ°ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªçš„æ¦‚ç‡ï¼š%f'%p_13) # é‡‡æ ·åˆ°ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªçš„æ¦‚ç‡ï¼š0.983567 # é‡‡æ ·åˆ°ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªçš„æ¦‚ç‡ï¼š0.923823 ç„¶è€Œï¼Œå¯¹äºä¸€ä¸ªå¤§å°ä¸º$n$çš„é›†åˆï¼Œä¸€å…±æœ‰$2^{n}$ç§ç»„åˆï¼Œå¦‚ä½•å¿«é€Ÿåœ°è¿›è¡Œ DPP çš„è®¡ç®—ä»¥åŠå¦‚ä½•æœ€å¿«æ‰¾åˆ°å¤§å°ä¸º$k$çš„å¤šæ ·æ€§æœ€å¤§çš„å­é›†æ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼Œç•™ç»™ä¸‹ä¸€ç¯‡ post\n","wordCount":"2889","inLanguage":"en","datePublished":"2023-04-21T15:20:00+08:00","dateModified":"2023-04-21T15:20:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://yunpengtai.top/posts/determinantal-point-process/"},"publisher":{"@type":"Organization","name":"Tai's Blog","logo":{"@type":"ImageObject","url":"http://yunpengtai.top/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://yunpengtai.top accesskey=h title="Home (Alt + H)">Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://yunpengtai.top/archives/ title=å½’æ¡£><span>å½’æ¡£</span></a></li><li><a href=http://yunpengtai.top/search/ title="æœç´¢ (Alt + /)" accesskey=/><span>æœç´¢</span></a></li><li><a href=http://yunpengtai.top/tags/ title=æ ‡ç­¾><span>æ ‡ç­¾</span></a></li><li><a href=http://yunpengtai.top/friends/ title=å‹äºº><span>å‹äºº</span></a></li><li><a href=http://yunpengtai.top/about/ title=å…³äº><span>å…³äº</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://yunpengtai.top>Home</a>&nbsp;Â»&nbsp;<a href=http://yunpengtai.top/posts/>Posts</a></div><h1 class=post-title>Determinantal Point Process</h1><div class=post-meta><span title='2023-04-21 15:20:00 +0800 CST'>April 21, 2023</span>&nbsp;Â·&nbsp;2889 words</div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e8%be%b9%e7%bc%98%e5%88%86%e5%b8%83 aria-label=è¾¹ç¼˜åˆ†å¸ƒ>è¾¹ç¼˜åˆ†å¸ƒ</a></li><li><a href=#l-ensemble aria-label=L-Ensemble>L-Ensemble</a></li><li><a href=#%e7%9b%b4%e8%a7%82%e8%a7%a3%e9%87%8a aria-label=ç›´è§‚è§£é‡Š>ç›´è§‚è§£é‡Š</a></li><li><a href=#demo aria-label=Demo>Demo</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><p>åœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šé¢ä¸´ä¸€ä¸ªé—®é¢˜ï¼šç»™å®šä¸€ä¸ªé›†åˆ<code>$\mathbf{S}$</code>ï¼Œä»ä¸­å¯»æ‰¾<code>$k$</code>ä¸ªæ ·æœ¬æ„æˆå­é›†<code>$\mathbf{V}$</code>ï¼Œå°½é‡ä½¿å¾—å­é›†çš„è´¨é‡é«˜åŒæ—¶å¤šæ ·æ€§å¥½ã€‚æ¯”å¦‚åœ¨æ¨èç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬å°±å¸Œæœ›ç»™ç”¨æˆ·æ¨èçš„ä¸œè¥¿å°½å¯èƒ½çš„æœ‰è´¨é‡ï¼ŒåŒæ—¶å…·æœ‰å·®å¼‚æ€§ã€‚</p><p>è€Œä½¿å¾—é‡‡æ ·çš„å­é›†å°½å¯èƒ½å…·å¤‡å¤šæ ·æ€§ä¾¿æ˜¯è¡Œåˆ—å¼ç‚¹è¿‡ç¨‹ï¼ˆDeterminantal Point Processï¼‰å¤§å±•èº«æ‰‹çš„åœ°æ–¹ï¼Œä¿—ç§° DPP</p><h2 id=è¾¹ç¼˜åˆ†å¸ƒ>è¾¹ç¼˜åˆ†å¸ƒ<a hidden class=anchor aria-hidden=true href=#è¾¹ç¼˜åˆ†å¸ƒ>#</a></h2><p>é¦–å…ˆå¼•å…¥ DPP çš„è¾¹ç¼˜åˆ†å¸ƒå®šä¹‰ï¼Œå½“æˆ‘ä»¬æŸæ¬¡é‡‡æ ·å‡ºå­é›†<code>$\mathbf{A}$</code>ï¼Œã€ŒåŒ…æ‹¬ã€<code>$\mathbf{V} = [\boldsymbol{v_{1}},\boldsymbol{v_{2}},\dots,\boldsymbol{v_{k}}] \in \mathbb{R}^{{d \times k}}$</code>çš„æ¦‚ç‡ï¼š</p><p><code>$$ P(\mathbf{V} \subseteq \mathbf{A}) = \det(\mathbf{K_{V}}) $$</code></p><p><code>$\mathbf{K}$</code>æ˜¯æ ¸çŸ©é˜µï¼ˆKernel Matrixï¼‰ï¼Œå³ï¼š</p><p><code>$$ \mathbf{K}_{ij} = k(\boldsymbol{v_{i}}, \boldsymbol{v_{j}}) $$</code></p><p><code>$\mathbf{K_{V}}$</code>æ˜¯ç”±<code>$\mathbf{V}$</code>ä¸­å…ƒç´ æ„æˆçš„å­çŸ©é˜µï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå‡å¦‚<code>$\mathbf{V}=\{ 1,2 \}$</code>ï¼Œé‚£ä¹ˆï¼š</p><p><code>$$ P(\mathbf{V} \subseteq \mathbf{A}) = \det(\mathbf{K_{V}}) = \left|\begin{array}{cc} \mathbf{K}_{11} & \mathbf{K}_{12} \\ \mathbf{K}_{21} & \mathbf{K}_{22} \end{array}\right| = \mathbf{K}_{11}\mathbf{K}_{22} - \mathbf{K}_{12}^{2} $$</code></p><p>å½“<code>$\mathbf{K}_{12}$</code>è¶Šå¤§ï¼Œåˆ™<code>$\{ 1,2 \}$</code>åŒæ—¶å‡ºç°åœ¨<code>$\mathbf{V}$</code>çš„æ¦‚ç‡å°±è¶Šå°ï¼Œä»è¿™ä¸ªè§’åº¦æƒ³ï¼Œæ ¸å‡½æ•°åº”è¯¥æ˜¯å‘ˆç°å‡ºæŸç§ç›¸ä¼¼æ€§</p><p>ä»æ­£å®šæ€§å‡ºå‘ï¼Œä¸¥æ ¼çš„å®šä¹‰å¦‚ä¸‹æ˜¯ï¼š<code>$\mathbf{0}\preceq\mathbf{K} \preceq \mathbf{I}$</code></p><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><p><code>$$ \mathbf{K} = \begin{bmatrix} 1 & -0.3 \\ -0.3 & 1 \end{bmatrix} $$</code></p><p>å…¶ç‰¹å¾å€¼ä¸º<code>$0.7, -1.3$</code>ï¼Œä¸æ»¡è¶³<code>$\mathbf{K}-\mathbf{0} \succeq \mathbf{0}$</code>ï¼Œå³ä¸æ˜¯åŠæ­£å®šçŸ©é˜µ</p><h2 id=l-ensemble>L-Ensemble<a hidden class=anchor aria-hidden=true href=#l-ensemble>#</a></h2><p>ç„¶è€Œï¼Œä¸Šé¢è¾¹ç¼˜å®šä¹‰åªæ˜¯å‘Šè¯‰æˆ‘ä»¬é‡‡æ ·æ—¶ï¼ŒæŸä¸ªå­é›†è¢«ã€ŒåŒ…æ‹¬ã€çš„æ¦‚ç‡ï¼Œå¹¶éå°±æ˜¯è¿™ä¸ªå­é›†ï¼Œè€Œè¿™ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡ L-Ensemble å»è§£</p><p><code>$$ P(\mathbf{V}=\mathbf{A}) \propto \det(\mathbf{L}) $$</code></p><p>è¿™é‡Œçš„<code>$\mathbf{L}$</code>çœç•¥äº†ä¸‹æ ‡ï¼Œè·Ÿä¸Šé¢çš„<code>$\mathbf{K}$</code>ä¸€æ ·ï¼Œæ˜¯è·Ÿ<code>$\mathbf{V}$</code>å…ƒç´ ç›¸å…³çš„å­çŸ©é˜µã€‚<code>$\mathbf{L}$</code>çŸ©é˜µçš„æ ¸å‡½æ•°æ˜¯å†…ç§¯æ˜¯<code>$\boldsymbol{v_{i}^{\top}\boldsymbol{v_{j}}}$</code>ï¼Œ<code>$\mathbf{V} = [\boldsymbol{v_{1}},\boldsymbol{v_{2}},\dots,\boldsymbol{v_{k}}] \in \mathbb{R}^{{d \times k}}$</code></p><p><code>$$ \mathbf{L} = \mathbf{V}^{\top}\mathbf{V} = \begin{bmatrix} \langle \boldsymbol{v_{1}}, \boldsymbol{v_{1}} \rangle & \langle \boldsymbol{v_{1}},\boldsymbol{v_{2}} \rangle & \dots & \langle \boldsymbol{v_{1}}, \boldsymbol{v_{k}} \rangle \\ \langle \boldsymbol{v_{2}},\boldsymbol{v_{1}} \rangle & \langle \boldsymbol{v_{2}},\boldsymbol{v_{2}} \rangle & \dots & \langle \boldsymbol{v_{2}},\boldsymbol{v_{k}} \rangle \\ \vdots & \vdots & \ddots & \vdots \\ \langle \boldsymbol{v_{k}},\boldsymbol{v_{1}} \rangle & \langle \boldsymbol{v_{k}},\boldsymbol{v_{2}} \rangle & \dots & \langle \boldsymbol{v_{k}},\boldsymbol{v_{k}} \rangle \end{bmatrix} $$</code></p><p>æ³¨æ„ï¼Œè¿™é‡ŒæŒ‡çš„ä¸æ˜¯æ¦‚ç‡ï¼Œè€Œæ˜¯è¯´æ¦‚ç‡ã€Œæ­£æ¯”äºã€<code>$\mathbf{L}$</code>çŸ©é˜µçš„è¡Œåˆ—å¼ï¼Œé‚£ä¹ˆå¦‚ä½•è®¡ç®—æ¦‚ç‡å‘¢ï¼Ÿä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¾—è®¡ç®—ä¸€ä¸ªå½’ä¸€åŒ–å¸¸æ•°ï¼ˆnormalization constantï¼‰ï¼Œå¯ä»¥ç±»æ¯”æŠ›ç¡¬å¸ï¼Œæˆ‘ä»¬å¾—å»æ±‚æ€»çš„æŠ›èµ·æ¬¡æ•°ï¼Œé™¤ä»¥å®ƒæ‰èƒ½å¾—åˆ°æ¦‚ç‡</p><p>å¼•å…¥ä¸‹è¿°å®šç†ï¼š</p><p><code>$$ \sum_{\mathbf{A}\subseteq \mathbf{V} \subseteq \mathbf{S}} \det(\mathbf{L}) = \det(\mathbf{L} + \mathbf{I_{\bar{A}}}) $$</code></p><p>å…¶ä¸­<code>$\mathbf{I_{\bar{A}}}$</code>æ˜¯å°†å•ä½çŸ©é˜µä¸­ä¸<code>$\mathbf{A}$</code>ç›¸å…³å…ƒç´ å…¨éƒ¨ç½®é›¶ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå½“<code>$\mathbf{S} = \{ 1,2,3 \}, \mathbf{A}={1,2}$</code>æ—¶ï¼š</p><p><code>$$ \mathbf{I_{\bar{A}}} = \begin{bmatrix} 0 & 0 & 0 \\ 0 & 0 & 0 \\ 0 & 0 & 1 \end{bmatrix} $$</code></p><p>é‚£ä¹ˆå¦‚ä½•æ±‚å½’ä¸€åŒ–å¸¸æ•°å‘¢ï¼Œå³å°†<code>$\mathbf{A}=\emptyset$</code>ï¼Œå½“<code>$\mathbf{A}$</code>ä¸ºç©ºé›†æ—¶ï¼Œä¾¿åŒ…æ‹¬äº†æ‰€æœ‰çš„æƒ…å†µï¼Œå³ï¼š</p><p><code>$$ P(\mathbf{V}=\mathbf{A}) = \frac{\det(\mathbf{L})}{\det(\mathbf{L}+\mathbf{I})} $$</code></p><p>å¦å¤–ï¼ŒL-Emsemble çš„<code>$\mathbf{K}, \mathbf{L}$</code>å¯¹åº”å…³ç³»å¦‚ä¸‹ï¼š</p><p><code>$$ \begin{align} \mathbf{K} & = \mathbf{L}(\mathbf{L} + \mathbf{I})^{-1} \\ \mathbf{L} & = \mathbf{K}(\mathbf{I}-\mathbf{K})^{-1} \end{align} $$</code></p><h2 id=ç›´è§‚è§£é‡Š>ç›´è§‚è§£é‡Š<a hidden class=anchor aria-hidden=true href=#ç›´è§‚è§£é‡Š>#</a></h2><p>é‚£ä¹ˆï¼Œè¡Œåˆ—å¼ä¸å¤šæ ·æ€§çš„ç›´è§‚è§£é‡Šæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>å¤šæ ·æ€§å’Œç›¸ä¼¼æ€§çš„æ„æ€æ­£å¥½ç›¸åï¼Œé€šå¸¸æˆ‘ä»¬ä¼šå®šä¹‰ç›¸ä¼¼æ€§ä¸ºä¸¤ä¸ªå‘é‡ä¹‹é—´åšç‚¹ç§¯ï¼Œå³ä¸º<code>$\boldsymbol{v_{1}}^{\top}\boldsymbol{v_{2}}$</code>ï¼Œç›´è§‚ä¸Šçœ‹ï¼Œä¸¤å‘é‡å¤¹è§’çš„ä½™å¼¦å€¼<code>$\cos \theta$</code> è¶Šå¤§ï¼Œç›¸ä¼¼æ€§è¶Šé«˜ï¼Œåè¿‡æ¥çœ‹ï¼Œå½“<code>$\cos \theta$</code>æœ€å°å³ä¸ºä¸¤è€…ç›¸ä¼¼æ€§æœ€å·®ï¼Œå¤šæ ·æ€§æœ€å¥½ã€‚æ˜¾ç„¶ï¼Œå½“ä¸¤å‘é‡æ­£äº¤æ—¶å¤šæ ·æ€§æœ€å¥½ã€‚</p><p>é‚£ä¹ˆï¼Œå¯¹äºä¸€ä¸ªå­é›†<code>$\mathbf{V} = [\boldsymbol{v_{1}},\boldsymbol{v_{2}},\dots,\boldsymbol{v_{k}}] \in \mathbb{R}^{{d \times k}}$</code>è€Œè¨€ï¼Œè¯¥å¦‚ä½•å®šä¹‰å®ƒçš„å¤šæ ·æ€§å‘¢ï¼Ÿä¸éš¾æƒ³å‡ºï¼Œå¯ä»¥é€šè¿‡çº¿æ€§æ— å…³å‘é‡çš„æ•°é‡æ¥å®šä¹‰ï¼Œè‹¥ä¸¤ä¸¤éƒ½äº’ä¸çº¿æ€§ç›¸å…³ï¼Œæ­¤æ—¶çš„å­é›†çš„å¤šæ ·æ€§æ˜¯æœ€å¥½çš„ã€‚ç›´è§‚ä¸Šå¯ä»¥è½¬æ¢ä¸ºæ„æˆçš„è¶…å¹³è¡Œä½“çš„ä½“ç§¯ï¼Œä¸‹æ–¹ä¸º<code>$k=2,3$</code>æ—¶çš„ç¤ºæ„å›¾</p><script src=https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css><script src=https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js></script>
<a data-fancybox=gallery href=https://s2.loli.net/2023/04/21/zFmw6A3LSoWxNlD.png><figure class=align-center><img loading=lazy src=https://s2.loli.net/2023/04/21/zFmw6A3LSoWxNlD.png#center alt=å›¾æºè‡ªç‹æ ‘æ£®è€å¸ˆçš„è¯¾ç¨‹ width=600px height=250px><figcaption><p><a href="https://www.youtube.com/watch?v=HjpJeUSekKs&amp;list=PLvOO0btloRntAi-VnV06M1Bu0X1xljUUP&amp;index=30">å›¾æºè‡ªç‹æ ‘æ£®è€å¸ˆçš„è¯¾ç¨‹</a></p></figcaption></figure></a><p>ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå¯ä»¥æ‹¿å¹³è¡Œå…­é¢ä½“ä¸ºä¾‹ï¼Œè‹¥å…¶ä¸­ä¸€ä¸ªå‘é‡ä¸å…¶ä»–å‘é‡çº¿æ€§ç›¸å…³ï¼Œé‚£ä¹ˆåˆ™ä¼šåç¼©æˆä¸€ä¸ªå¹³é¢ï¼Œæ„ä¸æˆå¹³è¡Œå…­é¢ä½“</p><script src=https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css><script src=https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js></script>
<a data-fancybox=gallery href=https://s2.loli.net/2023/04/21/6pE7uKy8PFaoHjR.gif><figure class=align-center><img loading=lazy src=https://s2.loli.net/2023/04/21/6pE7uKy8PFaoHjR.gif#center alt="å›¾æºè‡ª 3BlueBrown å¯¹äºè¡Œåˆ—å¼çš„ä»‹ç»" width=500px height=300px><figcaption><p><a href="https://www.youtube.com/watch?v=Ip3X9LOh2dk">å›¾æºè‡ª 3BlueBrown å¯¹äºè¡Œåˆ—å¼çš„ä»‹ç»</a></p></figcaption></figure></a><div class="notice notice-note"><div class=notice-title><svg xmlns="http://www.w3.org/2000/svg" class="icon notice-icon" viewBox="0 0 512 512"><path d="M504 256A248 248 0 118 256a248 248 0 01496 0zm-248 50a46 46 0 100 92 46 46 0 000-92zm-44-165 8 136c0 6 5 11 12 11h48c7 0 12-5 12-11l8-136c0-7-5-13-12-13h-64c-7 0-12 6-12 13z"/></svg></div><p>åªæœ‰å½“æ‰€æœ‰å‘é‡ä¸¤ä¸¤éƒ½çº¿æ€§æ— å…³æ—¶ï¼Œæ„æˆçš„è¶…å¹³è¡Œä½“ä½“ç§¯æœ€å¤§ï¼Œå³å¤šæ ·æ€§æœ€å¥½</p></div><p>è€Œè¡Œåˆ—å¼å¯ä»¥è¡¨ç¤ºä½“ç§¯ï¼Œä¸‹å¼ä¸­<code>$\text{vol}$</code>ä»£è¡¨ä½“ç§¯ï¼ˆvolumeï¼‰ï¼Œæ­¤æ—¶<code>$k=d$</code>ï¼Œ<code>$\mathbf{V}$</code>ä¸ºæ–¹é˜µ</p><p><code>$$ \det(\mathbf{V})= \text{vol}(\mathcal{P}(\boldsymbol{v_{1}}, \boldsymbol{v_{2}}, \dots, \boldsymbol{v_{k}})) $$</code></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¡Œåˆ—å¼çš„å¤§å°æ¥å®šä¹‰å¤šæ ·æ€§</p><p>é‚£ä¹ˆï¼Œ<code>$\mathbf{L}$</code>çš„è¡Œåˆ—å¼æ˜¯å¦ä¹Ÿè·Ÿä½“ç§¯æœ‰å…³å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼š</p><p><code>$$ \det(\mathbf{L}) = \text{vol}\bigg(\mathcal{P}(\boldsymbol{v_{1}}, \boldsymbol{v_{2}}, \dots,\boldsymbol{v_{k}})\bigg)^{2} $$</code></p><p>æ¥ä¸‹æ¥è¯æ˜è¿™ä¸€ç»“è®ºï¼š</p><p>ç”±äº<code>$k \leq d$</code>ï¼Œå› ä¸º<code>$d$</code>ç»´ç©ºé—´è‡³å¤šå­˜åœ¨<code>$d$</code>ä¸ªä¸¤ä¸¤çº¿æ€§æ— å…³çš„å‘é‡ï¼Œé‚£ä¹ˆè‚¯å®šå­˜åœ¨ä¸€ä¸ª<code>$k$</code>ç»´å­ç©ºé—´<code>$\mathcal{H}$</code>ï¼Œå­˜åœ¨æ­£äº¤çŸ©é˜µ<code>$\mathbf{R} \in \mathbb{R}^{d \times d}$</code>ï¼Œå¯¹å‘é‡<code>$\boldsymbol{v_{1}}, \boldsymbol{v_{2}}, \dots, \boldsymbol{v_{k}}$</code>è¿›è¡Œæ—‹è½¬ï¼Œä½¿å¾—<code>$\mathbf{R}\boldsymbol{v_{1}}, \mathbf{R}\boldsymbol{v_{2}}, \dots, \mathbf{R}\boldsymbol{v_{k}}$</code>éƒ½è½åœ¨å­ç©ºé—´<code>$\mathcal{H}$</code>ä¸Šã€‚ä¸å¦¨è®¾<code>$\mathcal{H}$</code>çš„åŸºåº•æ˜¯å‰<code>$k$</code>ä¸ªæ ‡å‡†æ­£äº¤åŸºï¼Œé‚£ä¹ˆï¼š</p><p><code>$$ \mathbf{R}\boldsymbol{v_{i}} = \begin{bmatrix} \boldsymbol{u_{i}} \\ \mathbf{0} \end{bmatrix} $$</code></p><p><code>$\boldsymbol{u_{i}} \in \mathbb{R}^{k}$</code>ï¼Œ<code>$\mathbf{0}$</code>ä¸€å…±æœ‰<code>$d-k$</code>ä¸ªï¼Œå› ä¸ºç”¨<code>$\mathcal{H}$</code>çš„åŸºåº•å‘é‡è¡¨ç¤ºï¼Œåé¢åªèƒ½ä¸º<code>$0$</code>ï¼Œå°†<code>$\boldsymbol{u_{1}}, \boldsymbol{u_{2}},\dots, \boldsymbol{u_{k}}$</code>å½“ä½œ<code>$\mathbf{U}$</code>çš„åˆ—ï¼Œå°±æœ‰ï¼š</p><p><code>$$ \mathbf{RV} = \begin{bmatrix} \mathbf{U} \\ \mathbf{0} \end{bmatrix}, \mathbf{U} \in \mathbb{R}^{k \times k} $$</code></p><p>æ˜¾ç„¶ï¼Œ<code>$\mathcal{P}(\boldsymbol{u_{1}}, \dots)$</code>ä¸<code>$\mathcal{P}([\boldsymbol{u_{1}};\boldsymbol{0}],\dots )$</code>ä¸¤è€…ä½“ç§¯ç›¸ç­‰</p><p><code>$$ \text{vol}(\mathcal{P}(\boldsymbol{u_{1}}, \boldsymbol{u_{2}},\dots, \boldsymbol{u_{k}})) = \text{vol}\bigg(\mathcal{P}\bigg(\begin{bmatrix} \boldsymbol{u_{1}} \\ \boldsymbol{0} \end{bmatrix}, \begin{bmatrix} \boldsymbol{u_{2}} \\ \boldsymbol{0} \\ \end{bmatrix}, \dots, \begin{bmatrix} \boldsymbol{u_{k}} \\ \boldsymbol{0} \end{bmatrix}\bigg)\bigg) $$</code></p><p>é‚£ä¹ˆï¼š</p><p><code>$$ \text{vol}(\mathcal{P}(\boldsymbol{u_{1}}, \boldsymbol{u_{2}}, \dots, \boldsymbol{u_{k}})) = \text{vol}\bigg(\mathcal{P}(\mathbf{R}\boldsymbol{v_{1}}, \mathbf{R}\boldsymbol{v_{2}}, \dots, \mathbf{R}\boldsymbol{v_{k}})\bigg) $$</code></p><p>ç”±äºå¯¹è¶…å¹³é¢ä½“è¿›è¡Œæ—‹è½¬ä¸æ”¹å˜å…¶ä½“ç§¯ï¼ˆæ³¨æ„ï¼Œè¿™é‡Œæ˜¯æ—‹è½¬è€Œä¸æ˜¯ä¸€èˆ¬çš„çº¿æ€§å˜æ¢ï¼Œä¸€èˆ¬çš„çº¿æ€§å˜æ¢ä¸å…·å¤‡è¯¥æ€§è´¨ï¼‰</p><p><code>$$ \text{vol}\bigg(\mathcal{P}(\mathbf{R}\boldsymbol{v_{1}}, \mathbf{R}\boldsymbol{v_{2}}, \dots, \mathbf{R}\boldsymbol{v_{k}})\bigg) = \text{vol}\bigg(\mathcal{P}(\boldsymbol{v_{1}}, \boldsymbol{v_{2}}, \dots, \boldsymbol{v_{k}})\bigg) $$</code></p><p>é‚£ä¹ˆï¼š</p><p><code>$$ \text{vol}(\mathcal{P}(\boldsymbol{u_{1}}, \boldsymbol{u_{2}}, \dots, \boldsymbol{u_{k}})) =\text{vol}\bigg(\mathcal{P}(\mathbf{R}\boldsymbol{v_{1}}, \mathbf{R}\boldsymbol{v_{2}}, \dots, \mathbf{R}\boldsymbol{v_{k}})\bigg) $$</code></p><p>åˆå› ä¸º<code>$\mathbf{R}$</code>æ­£äº¤çŸ©é˜µï¼Œå³<code>$\mathbf{R}^{\top}\mathbf{R} = \mathbf{I}$</code>ï¼Œé‚£ä¹ˆï¼š</p><p><code>$$ \mathbf{U}^{\top}\mathbf{U} = (\mathbf{RV})^{\top}\mathbf{RV} = \mathbf{V}^{\top}(\mathbf{R}^{\top}\mathbf{R)}\mathbf{V} = \mathbf{V}^{\top}\mathbf{V} $$</code></p><p>æ‰€ä»¥ï¼š</p><p><code>$$ \det(\mathbf{V}^{\top}\mathbf{V}) = \det(\mathbf{U}^{\top}\mathbf{U}) = \det(\mathbf{U})^{2} = \text{vol}\bigg(\mathcal{P}(\boldsymbol{v_{1}}, \boldsymbol{v_{2}}, \dots, \boldsymbol{v_{k}})\bigg)^{2} $$</code></p><p>ä» L-Emsemble è§’åº¦çœ‹ï¼Œè¢«é‡‡æ ·çš„æ¦‚ç‡æ­£æ¯”äºæ„æˆçš„è¶…å¹³é¢ä½“çš„ä½“ç§¯ï¼Œå³ä¸¤ä¸¤ä¹‹é—´çº¿æ€§æ— å…³æ›´å®¹æ˜“è¢«é‡‡æ ·å‡º</p><h2 id=demo>Demo<a hidden class=anchor aria-hidden=true href=#demo>#</a></h2><p>æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨ä¾‹å­æ¥çœ‹ä¸€ä¸‹æ˜¯å¦ DPP èƒ½å¤Ÿé‡‡æ ·å‡ºæ›´æœ‰å¤šæ ·æ€§çš„å­é›†</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>torch</span> <span class=kn>import</span> <span class=n>det</span><span class=p>,</span> <span class=n>eye</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>transformers</span> <span class=kn>import</span> <span class=n>set_seed</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>transformers</span> <span class=kn>import</span> <span class=n>BertModel</span><span class=p>,</span> <span class=n>BertTokenizer</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>set_seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pretrain_path</span> <span class=o>=</span> <span class=s2>&#34;fabriceyhc/bert-base-uncased-imdb&#34;</span>
</span></span><span class=line><span class=cl><span class=n>model</span> <span class=o>=</span> <span class=n>BertModel</span><span class=o>.</span><span class=n>from_pretrained</span><span class=p>(</span><span class=n>pretrain_path</span><span class=p>)</span><span class=o>.</span><span class=n>cuda</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>tk</span> <span class=o>=</span> <span class=n>BertTokenizer</span><span class=o>.</span><span class=n>from_pretrained</span><span class=p>(</span><span class=n>pretrain_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>input_text</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;I am happy because the weather is extremely good!&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;I hate the bad weather&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;The weather is extremely good!&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>inputs</span> <span class=o>=</span> <span class=n>tk</span><span class=p>(</span><span class=n>input_text</span><span class=p>,</span> <span class=n>max_length</span><span class=o>=</span><span class=mi>128</span><span class=p>,</span> <span class=n>return_tensors</span><span class=o>=</span><span class=s2>&#34;pt&#34;</span><span class=p>,</span> <span class=n>truncation</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>padding</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>inputs</span> <span class=o>=</span> <span class=p>{</span><span class=n>k</span><span class=p>:</span> <span class=n>v</span><span class=o>.</span><span class=n>cuda</span><span class=p>()</span> <span class=k>for</span> <span class=n>k</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>inputs</span><span class=o>.</span><span class=n>items</span><span class=p>()}</span>
</span></span><span class=line><span class=cl><span class=n>outputs</span> <span class=o>=</span> <span class=n>model</span><span class=p>(</span><span class=o>**</span><span class=n>inputs</span><span class=p>)</span><span class=o>.</span><span class=n>pooler_output</span><span class=o>.</span><span class=n>T</span>
</span></span><span class=line><span class=cl><span class=n>vtv</span> <span class=o>=</span> <span class=n>outputs</span><span class=o>.</span><span class=n>T</span> <span class=o>@</span> <span class=n>outputs</span>
</span></span><span class=line><span class=cl><span class=n>group_12</span> <span class=o>=</span> <span class=n>vtv</span><span class=p>[:</span><span class=mi>2</span><span class=p>][:,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>]]</span>
</span></span><span class=line><span class=cl><span class=n>I</span> <span class=o>=</span> <span class=n>eye</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span><span class=o>.</span><span class=n>cuda</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>p_12</span> <span class=o>=</span> <span class=n>det</span><span class=p>(</span><span class=n>group_12</span><span class=p>)</span> <span class=o>/</span> <span class=n>det</span><span class=p>(</span><span class=n>group_12</span> <span class=o>+</span> <span class=n>I</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>group_13</span> <span class=o>=</span> <span class=n>vtv</span><span class=p>[[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>]][:,</span> <span class=p>[</span><span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>]]</span>
</span></span><span class=line><span class=cl><span class=n>p_13</span> <span class=o>=</span> <span class=n>det</span><span class=p>(</span><span class=n>group_13</span><span class=p>)</span> <span class=o>/</span> <span class=n>det</span><span class=p>(</span><span class=n>group_13</span> <span class=o>+</span> <span class=n>I</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;é‡‡æ ·åˆ°ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªçš„æ¦‚ç‡ï¼š</span><span class=si>%f</span><span class=s1>&#39;</span><span class=o>%</span><span class=n>p_12</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s1>&#39;é‡‡æ ·åˆ°ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªçš„æ¦‚ç‡ï¼š</span><span class=si>%f</span><span class=s1>&#39;</span><span class=o>%</span><span class=n>p_13</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># é‡‡æ ·åˆ°ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªçš„æ¦‚ç‡ï¼š0.983567</span>
</span></span><span class=line><span class=cl><span class=c1># é‡‡æ ·åˆ°ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªçš„æ¦‚ç‡ï¼š0.923823</span>
</span></span></code></pre></div><p>ç„¶è€Œï¼Œå¯¹äºä¸€ä¸ªå¤§å°ä¸º<code>$n$</code>çš„é›†åˆï¼Œä¸€å…±æœ‰<code>$2^{n}$</code>ç§ç»„åˆï¼Œå¦‚ä½•å¿«é€Ÿåœ°è¿›è¡Œ DPP çš„è®¡ç®—ä»¥åŠå¦‚ä½•æœ€å¿«æ‰¾åˆ°å¤§å°ä¸º<code>$k$</code>çš„å¤šæ ·æ€§æœ€å¤§çš„å­é›†æ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼Œç•™ç»™ä¸‹ä¸€ç¯‡ post</p></div><div style="margin-top:2em;padding:1em;border:0 solid;border-radius:10px;background-color:var(--code-bg)"><h3>ğŸ±å¦‚æœæ‚¨æƒ³è¦å¼•ç”¨ï¼Œè¯·è€ƒè™‘å¦‚ä¸‹æ ¼å¼ï¼š</h3><div style=padding-top:.5em>å°è¿é¹. (Apr. 21, 2023). ã€ŠDeterminantal Point Processã€‹[Blog
post]. Retrieved from http://yunpengtai.top/posts/determinantal-point-process/</div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>@online{blog-a1f3ef8572fbb0abe2ce90766c3ead26,
</span></span><span class=line><span class=cl>        title=Determinantal Point Process,
</span></span><span class=line><span class=cl>        author={Yunpeng Tai},
</span></span><span class=line><span class=cl>        year=2023,
</span></span><span class=line><span class=cl>        month=Apr,
</span></span><span class=line><span class=cl>        url=http://yunpengtai.top/posts/determinantal-point-process/,
</span></span><span class=line><span class=cl>        note=yunpengtai.typ@gmail.com,
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><div style=padding-bottom:.4em>è‡ªç”±è½¬è½½-éå•†ç”¨-éè¡ç”Ÿ-ä¿æŒç½²åï¼ˆ<a href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank>CC BY-NC-SA 4.0ï¼‰</a></div></div><footer class=post-footer><ul class=post-tags><li><a href=http://yunpengtai.top/tags/ml/>ML</a></li></ul><nav class=paginav><a class=prev href=http://yunpengtai.top/posts/fast-greedy-map-inference-for-dpp/><span class=title>Â« Prev</span><br><span>Fast Greedy MAP Inference for DPP</span></a>
<a class=next href=http://yunpengtai.top/posts/generalized-linear-models/><span class=title>Next Â»</span><br><span>Generalized Linear Models</span></a></nav></footer><link rel=stylesheet href=https://unpkg.com/katex@0.16.7/dist/katex.min.css><script src=https://unpkg.com/katex@0.16.7/dist/katex.min.js></script>
<link href=https://cdn.jsdelivr.net/gh/sherlcok314159/artalk-assets@main/artalk.css rel=stylesheet><script src=https://cdnjs.cloudflare.com/ajax/libs/artalk/2.8.6/Artalk.js></script>
<script src=https://unpkg.com/@artalk/plugin-katex@latest/dist/artalk-plugin-katex.js></script><div id=Comments></div><script>const artalk=Artalk.init({el:"#Comments",pageKey:"",pageTitle:"Determinantal Point Process",server:"https://comment.yunpengtai.top",site:"Tai's Blog",darkMode:localStorage.getItem("pref-theme")=="dark"});document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?artalk.setDarkMode(!1):artalk.setDarkMode(!0)})</script></article></main><footer class=footer><span>&copy; 2024 <a href=http://yunpengtai.top>Tai's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/sherlcok314159/MyPaperMod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>(function(e,t){var s=document,o="script",n=s.createElement(o),i=s.getElementsByTagName(o)[0];n.src=e,t&&n.addEventListener("load",function(e){t(e)}),i.parentNode.insertBefore(n,i)})("/js/pangu.min.js",function(){pangu.spacingPage()})</script><script>(function(){var e,t,n,s=document.getElementsByTagName("code");for(n=0;n<s.length;){if(t=s[n],t.parentNode.tagName!=="PRE"&&t.childElementCount===0&&(e=t.textContent,/^\$[^$]/.test(e)&&/[^$]\$$/.test(e)&&(e=e.replace(/^\$/,"\\(").replace(/\$$/,"\\)"),t.textContent=e),/^\\\((.|\s)+\\\)$/.test(e)||/^\\\[(.|\s)+\\\]$/.test(e)||/^\$(.|\s)+\$$/.test(e)||/^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(e))){t.outerHTML=t.innerHTML;continue}n++}})()</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>
<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Fast Greedy MAP Inference for DPP | Tai's Blog</title><meta name=keywords content="ML"><meta name=description content="é—®é¢˜ å…ˆè§„å®šä¸€äº›æœ¯è¯­ï¼šè®°é€‰ä¸­å…ƒç´ æ„æˆçš„é›†åˆä¸º$\mathcal{S}$ï¼Œæœªé€‰ä¸­æ„æˆçš„å…ƒç´ è®°ä¸º$\mathcal{R}$ï¼Œ$\mathbf{L}"><meta name=author content><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="eAKh7zszsOtNde1wyq_sUo95ZPH4zTTJhR-_ol4VWDs"><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.js onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=http://yunpengtai.top/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://yunpengtai.top/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://yunpengtai.top/favicon-32x32.png><link rel=apple-touch-icon href=http://yunpengtai.top/apple-touch-icon.png><link rel=mask-icon href=http://yunpengtai.top/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script>MathJax={loader:{load:["[tex]/boldsymbol"]},tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0,tags:"all",packages:{"[+]":["boldsymbol"]}}}</script><script src=https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml-full.js integrity="sha256-kbAFUDxdHwlYv01zraGjvjNZayxKtdoiJ38bDTFJtaQ=" crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-Y3CX2RWEDY"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Y3CX2RWEDY",{anonymize_ip:!1})}</script><meta property="og:title" content="Fast Greedy MAP Inference for DPP"><meta property="og:description" content="é—®é¢˜ å…ˆè§„å®šä¸€äº›æœ¯è¯­ï¼šè®°é€‰ä¸­å…ƒç´ æ„æˆçš„é›†åˆä¸º$\mathcal{S}$ï¼Œæœªé€‰ä¸­æ„æˆçš„å…ƒç´ è®°ä¸º$\mathcal{R}$ï¼Œ$\mathbf{L}"><meta property="og:type" content="article"><meta property="og:url" content="http://yunpengtai.top/posts/fast-greedy-map-inference-for-dpp/"><meta property="og:image" content="http://yunpengtai.top/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-05-16T10:20:00+08:00"><meta property="article:modified_time" content="2023-05-16T10:20:00+08:00"><meta property="og:site_name" content="Tai's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://yunpengtai.top/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Fast Greedy MAP Inference for DPP"><meta name=twitter:description content="é—®é¢˜ å…ˆè§„å®šä¸€äº›æœ¯è¯­ï¼šè®°é€‰ä¸­å…ƒç´ æ„æˆçš„é›†åˆä¸º$\mathcal{S}$ï¼Œæœªé€‰ä¸­æ„æˆçš„å…ƒç´ è®°ä¸º$\mathcal{R}$ï¼Œ$\mathbf{L}"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"http://yunpengtai.top/posts/"},{"@type":"ListItem","position":3,"name":"Fast Greedy MAP Inference for DPP","item":"http://yunpengtai.top/posts/fast-greedy-map-inference-for-dpp/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Fast Greedy MAP Inference for DPP","name":"Fast Greedy MAP Inference for DPP","description":"é—®é¢˜ å…ˆè§„å®šä¸€äº›æœ¯è¯­ï¼šè®°é€‰ä¸­å…ƒç´ æ„æˆçš„é›†åˆä¸º$\\mathcal{S}$ï¼Œæœªé€‰ä¸­æ„æˆçš„å…ƒç´ è®°ä¸º$\\mathcal{R}$ï¼Œ$\\mathbf{L}","keywords":["ML"],"articleBody":"é—®é¢˜ å…ˆè§„å®šä¸€äº›æœ¯è¯­ï¼šè®°é€‰ä¸­å…ƒç´ æ„æˆçš„é›†åˆä¸º$\\mathcal{S}$ï¼Œæœªé€‰ä¸­æ„æˆçš„å…ƒç´ è®°ä¸º$\\mathcal{R}$ï¼Œ$\\mathbf{L}$æ˜¯æ ¸çŸ©é˜µï¼ˆæ ¸å‡½æ•°æ˜¯å†…ç§¯ï¼‰ï¼Œ$\\mathbf{L_{V}}$æ˜¯ç”±é›†åˆ$S$çš„å…ƒç´ æ„æˆçš„å­çŸ©é˜µ\nåœ¨ Determinatal Point Process ä¸­æˆ‘ä»¬æåˆ°åœ¨å¤§å°ä¸º$n$çš„é›†åˆé‡Œå»æŒ‘é€‰$k$ä¸ªç‰©å“æ„æˆé›†åˆ$S$, ä½¿å¾—$\\det(\\mathbf{L}_{\\mathbf{V}})$æœ€å¤§ä¾¿æ˜¯æˆ‘ä»¬çš„ç›®æ ‡ï¼Œç„¶è€Œï¼Œæ€ä¹ˆå»é‡Œé¢æŒ‘é€‰$\\mathbf{V}$å´æ˜¯ NP-Hard é—®é¢˜ï¼Œä¸ºæ­¤ï¼ŒChen et al., 2018 æå‡ºäº†ä¸€ç¯‡æ¯”è¾ƒå·§å¦™çš„è´ªå©ªç®—æ³•ä½œä¸ºè¿‘ä¼¼è§£ï¼Œå¹¶ä¸”æ•´ä¸ªç®—æ³•çš„å¤æ‚ä»…æœ‰$\\mathcal{O}(nk^{2})$\næš´åŠ›æ±‚è§£ æˆ‘ä»¬äººä¸ºè§„å®šäº†è¦é€‰æ‹©$k$ä¸ªï¼Œè¿™ç›¸å½“äºæ˜¯ä¸€ç§å‰éªŒåˆ†å¸ƒï¼Œé‚£ä¹ˆ k-DPP å…¶å®å°±æ˜¯æœ€å¤§åŒ–åéªŒæ¦‚ç‡ï¼ˆMAPï¼‰çš„ä¸€ç§ï¼Œæ¯ä¸€æ­¥çš„ç›®æ ‡å°±æ˜¯é€‰æ‹©ä¼šè®©æ–°çŸ©é˜µçš„è¡Œåˆ—å¼å˜å¾—æœ€å¤§çš„å…ƒç´ \n$$ j = \\mathop{ \\arg \\max}_{i \\in \\mathcal{R}} \\log \\det(\\mathbf{L}_{\\mathcal{S} \\cup \\{i\\}}) - \\log \\det(\\mathbf{L}_{\\mathcal{S}}) $$\nå¯¹äºä¸€ä¸ª$n\\times n$çš„æ–¹é˜µè€Œè¨€ï¼Œæ±‚å®ƒçš„è¡Œåˆ—å¼éœ€è¦$\\mathcal{O}(n^{3})$ï¼ˆæ¯ä¸€è½®æ¶ˆå…ƒçš„å¤æ‚åº¦æ˜¯$\\mathcal{O}(n^{2})$ï¼Œè€Œè¦è¿›è¡Œ$n-1$è½®æ¶ˆå…ƒï¼‰\nè¿™é‡Œçš„è¯ï¼Œæ¯æ¬¡è¦å¯¹$\\mathcal{R}$æ‰€æœ‰çš„å…ƒç´ æ±‚ä¸€æ¬¡è¡Œåˆ—å¼ï¼Œè€Œè¡Œåˆ—å¼çš„ä¸º$\\mathcal{O}(|\\mathcal{S}|^{3})$ï¼ŒåŒæ—¶éœ€è¦é€‰$k$ä¸ªï¼Œå¤æ‚åº¦å˜ä¸ºäº†$\\mathcal{O}(|\\mathcal{S}|^{3} \\cdot |\\mathcal{R}| \\cdot k)$ï¼Œå³ä¸º$\\mathcal{O}(nk^{4})$ï¼Œæš´åŠ›æ±‚è§£çš„è¯å¤æ‚åº¦å¾ˆå¤§ï¼Œæ­¤æ—¶åŸä½œè€…ä¾¿æå‡ºäº†åˆ©ç”¨ Cholesky åˆ†è§£çš„æ–¹å¼æ¥è¿›è¡Œæ±‚è§£ï¼Œå·§å¦™åœ°å°†å¤æ‚åº¦é™åˆ°äº†$\\mathcal{O}(nk^{2})$\nCholesky åˆ†è§£ $\\mathbf{L}_{\\mathcal{S}}$æ˜¯å¯¹ç§°åŠæ­£å®šçŸ©é˜µï¼Œè¯æ˜å¦‚ä¸‹ï¼š$\\forall \\boldsymbol{z} \\in \\mathbb{R}^{n}$\n$$ \\boldsymbol{z}^{\\top}\\mathbf{L}_{\\mathcal{S}}\\boldsymbol{z} = \\boldsymbol{z}^{\\top} \\mathbf{V}^{\\top}\\mathbf{V} \\boldsymbol{z} = \\|\\mathbf{V}\\boldsymbol{z}\\|_{2}^{2} \\geq 0 \\quad \\blacksquare $$\né‚£ä¹ˆ$\\mathbf{L}_{\\mathcal{S}}$å­˜åœ¨ Cholesky åˆ†è§£ï¼Œå³$\\mathbf{L}_{\\mathcal{S}}=\\mathbf{U}\\mathbf{U}^{\\top}$ï¼Œè¿™é‡Œçš„$\\mathbf{U}$æ˜¯å¤§å°ä¸º$|\\mathcal{S}|\\times|\\mathcal{S}|$çš„ä¸‹ä¸‰è§’çŸ©é˜µï¼Œ$\\mathbf{L}_{\\mathcal{S}\\cup \\{ i \\}}$æ¯”$\\mathbf{L}_{\\mathcal{S}}$å¤šäº†ä¸€è¡Œå’Œä¸€åˆ—ï¼Œå³ä¸ºï¼š\n$$ \\mathbf{L}_{\\mathcal{S}\\cup \\{ i \\}} = \\begin{bmatrix} \\mathbf{L}_{\\mathcal{S} } \u0026 \\boldsymbol{u}_{i} \\\\ \\boldsymbol{u}_{i}^{\\top} \u0026 \\boldsymbol{u}_{i}^{\\top}\\boldsymbol{u} \\end{bmatrix} $$\nè€Œè¿™é‡Œé»˜è®¤æ¯ä¸ªå‘é‡æ˜¯ç»è¿‡å½’ä¸€åŒ–çš„ï¼Œå³$\\boldsymbol{u}_{i}^{\\top}\\boldsymbol{u}=1$ï¼Œé‚£ä¹ˆ$\\mathbf{L}_{\\mathcal{S}\\cup \\{ i \\}}$çš„ Cholesky åˆ†è§£å³ä¸ºä¸‹å¼ï¼Œå…¶ä¸­$\\boldsymbol{c}_{i} \\in \\mathbb{R}^{1 \\times |\\mathcal{S}| }, d_{i} \\geq 0$ï¼š\n$$ \\mathbf{L}_{\\mathcal{S}\\cup \\{ i \\}} = \\begin{bmatrix} \\mathbf{U} \u0026 \\boldsymbol{0} \\\\ \\boldsymbol{c}_{i} \u0026 d_{i} \\end{bmatrix}\\begin{bmatrix} \\mathbf{U} \u0026 \\boldsymbol{0} \\\\ \\boldsymbol{c}_{i} \u0026 d_{i} \\end{bmatrix}^{\\top} $$\nç»“åˆä¸Šé¢ä¸¤å¼ï¼š\n$$ \\mathbf{L}_{\\mathcal{S}\\cup \\{ i \\}} = \\begin{bmatrix} \\mathbf{L}_{\\mathcal{S} } \u0026 \\boldsymbol{u}_{i} \\\\ \\boldsymbol{u}_{i}^{\\top} \u0026 \\boldsymbol{u}_{i}^{\\top}\\boldsymbol{u} \\end{bmatrix} = \\begin{bmatrix} \\mathbf{U}\\mathbf{U}^{\\top} \u0026 \\mathbf{U}\\boldsymbol{c}_{i}^{\\top} \\\\ \\boldsymbol{c}_{i}\\mathbf{U}^{\\top} \u0026 \\boldsymbol{c}_{i}\\boldsymbol{c}_{i}^{\\top} + d_{i}^{2} \\end{bmatrix} $$\nå¯å¾—ï¼š\n$$ \\boldsymbol{u}_{i} = \\mathbf{U}\\boldsymbol{c}_{i}^{\\top}, 1 = \\boldsymbol{c}_{i}\\boldsymbol{c}_{i}^{\\top} + d_{i}^{2} $$\né‚£ä¹ˆï¼š\n$$ \\det(\\mathbf{L}_{\\mathcal{S}\\cup \\{ i \\}}) = \\det \\bigg(\\begin{bmatrix} \\mathbf{U} \u0026 \\boldsymbol{0} \\\\ \\boldsymbol{c}_{i} \u0026 d_{i} \\end{bmatrix}\\begin{bmatrix} \\mathbf{U} \u0026 \\boldsymbol{0} \\\\ \\boldsymbol{c}_{i} \u0026 d_{i} \\end{bmatrix}^{\\top}\\bigg) = \\det(\\mathbf{U}\\mathbf{U}^{\\top})\\cdot d_{i}^{2}= \\det(\\mathbf{L}_{\\mathcal{S}}) \\cdot d_{i}^{2} $$\nè¿™æ ·æˆ‘ä»¬ä¸€å¼€å§‹çš„ä¼˜åŒ–ç›®æ ‡å°±å¯ä»¥ç®€åŒ–ä¸ºï¼š\n$$ j = \\mathop{\\arg \\max}_{i \\in \\mathcal{R}} \\log(d_{i}^{2}) $$\næ¥ä¸‹æ¥ï¼Œå½“æˆ‘ä»¬å¾—åˆ°$d_j$æ—¶ï¼Œä¾¿å¯ä»¥ç®—å‡º$c_{j}$ï¼Œé‚£ä¹ˆæ·»åŠ $j$ä¹‹åçš„æ–°é›†åˆ$\\mathcal{S}'$çš„ Cholesky åˆ†è§£ä¾¿å¯ä»¥æ±‚å¾—ï¼š\n$$ \\mathbf{L}_{\\mathcal{S}'} = \\begin{bmatrix} \\mathbf{U} \u0026 \\boldsymbol{0} \\\\ \\boldsymbol{c}_{j} \u0026 d_{j} \\end{bmatrix}\\begin{bmatrix} \\mathbf{U} \u0026 \\boldsymbol{0} \\\\ \\boldsymbol{c}_{j} \u0026 d_{j} \\end{bmatrix}^{\\top} $$\nå¢é‡æ›´æ–° æ¥ä¸‹æ¥ä¾¿æ˜¯é‡å¤´æˆï¼Œè¿™ä¸€è½®æˆ‘ä»¬å·²ç»å¾—åˆ°äº†æœ€å¥½çš„$d_{j}$äº†ï¼Œä¸‹ä¸€è½®æˆ‘ä»¬æ€ä¹ˆæ±‚å‡ºæœ€å¤§çš„$d_{i}$å‘¢ï¼Ÿ\nå¯ä»¥åˆ©ç”¨ä¹‹å‰æ±‚å‡ºçš„$c_{i}, d_{i}$æ¥è·å–å½“å‰çš„$c_{i}', d_{i}'$ï¼Œè¿™ä¾¿æ˜¯è®ºæ–‡çš„æ ¸å¿ƒï¼šå¢é‡æ›´æ–°\nåœ¨æˆ‘ä»¬é€‰æ‹©äº†$j$åï¼Œ$c_{i}$å¤šäº†ä¸€ä¸ªå…ƒç´ ï¼Œä¸å¦¨è®°$\\boldsymbol{c}_{i}' = [\\boldsymbol{c}_{i}, {e}_{i}]$ï¼Œå›å¿†ä¸Šé¢çš„å¼å­ï¼š\n$$ \\mathbf{L}_{\\mathcal{S}\\cup \\{ i \\}} = \\begin{bmatrix} \\mathbf{L}_{\\mathcal{S} } \u0026 \\boldsymbol{u}_{i} \\\\ \\boldsymbol{u}_{i}^{\\top} \u0026 \\boldsymbol{u}_{i}^{\\top}\\boldsymbol{u} \\end{bmatrix} = \\begin{bmatrix} \\mathbf{U}\\mathbf{U}^{\\top} \u0026 \\mathbf{U}\\boldsymbol{c}_{i}^{\\top} \\\\ \\boldsymbol{c}_{i}\\mathbf{U}^{\\top} \u0026 \\boldsymbol{c}_{i}\\boldsymbol{c}_{i}^{\\top} + d_{i}^{2} \\end{bmatrix} $$\nä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶ä¸­$\\boldsymbol{u}_{i}$å°±æ˜¯ç¬¬$i$ä¸ªå…ƒç´ ä¸é›†åˆ$\\mathcal{S}$å¯¹åº”å‘é‡åšå†…ç§¯çš„ç»“æœ\n$$ \\boldsymbol{u}_{i} = \\mathbf{U}\\boldsymbol{c}_{i}^{\\top} $$\né‚£ä¹ˆï¼Œç±»æ¯”ä¸€ä¸‹ï¼Œ$\\mathbf{U}_{j}$æ˜¯$\\mathbf{L}_{\\mathcal{S}'}$çš„ Cholesky åˆ†è§£\n$$ \\underbrace{\\begin{bmatrix} \\mathbf{U} \u0026 \\boldsymbol{0} \\\\ \\boldsymbol{c}_{j} \u0026 d_{j} \\end{bmatrix}}_{\\mathbf{U}_{j}} \\boldsymbol{c}_{i}'^{\\top} = \\boldsymbol{u}_{i}' = \\begin{bmatrix} \\boldsymbol{u}_{i} \\\\ \\mathbf{L}_{ji} \\end{bmatrix} $$\nç»§è€Œï¼š\n$$ \\langle \\boldsymbol{c}_{j},\\boldsymbol{c} _{i}\\rangle + d_{j}e_{i} = \\mathbf{L}_{ji} \\implies e_{i} = \\frac{\\mathbf{L}_{ji}-\\langle \\boldsymbol{c}_{j},\\boldsymbol{c}_{i} \\rangle }{d_{j}} $$\næ±‚å‡º$e_{i}$ä¹‹åï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥æ±‚å‡º$d_{i}'$ï¼š\n$$ d_{i}'^{2} = 1 - \\|\\boldsymbol{c}_{i}'\\|_{2}^{2} =\\underbrace{ 1- \\|\\boldsymbol{c}_{i}\\|_{2}^{2} }_{ {\\color{#337dff}d_{i}^{2} }} - e_{i}^{2} = d_{i}^{2} - e_{i}^{2} $$\næµç¨‹ ç®—æ³•æ•´ä½“æµç¨‹\né‚£æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹å¤æ‚åº¦ï¼Œæ¯é€‰ä¸€ä¸ª$j$éœ€è¦è¿›è¡Œ$|\\mathcal{R}| \\cdot |\\mathcal{S}|$æ¬¡æ“ä½œï¼Œè€Œ$|\\mathcal{R}|\\leq n, |\\mathcal{S}| \\leq k$ï¼Œä¹Ÿå°±æ˜¯$\\mathcal{O}(nk)$ï¼Œå¾—è¿›è¡Œ$k$æ¬¡è¿­ä»£ï¼Œé‚£ä¹ˆæ€»çš„å¤æ‚åº¦å³ä¸º$\\mathcal{O}(nk^{2})$ï¼Œç”±$\\mathcal{O}(nk^{4})$é™åˆ°$\\mathcal{O}(nk^{2})$ï¼Œæ˜¯ä¸é”™çš„è¿›æ­¥\nä»£ç  ç†Ÿæ‚‰äº†æ•´ä¸ªæµç¨‹ä¹‹åï¼Œä»£ç æƒ³å¿…ä¹Ÿæ˜¯å‘¼ä¹‹æ¬²å‡ºäº†\nimport math import numpy as np def fast_map_dpp(kernel_matrix, max_length): cis = np.zeros((max_length, kernel_matrix.shape[0])) di2s = np.copy(np.diag(kernel_matrix)) selected = np.argmax(di2s) selected_items = [selected] while len(selected_items) \u003c max_length: idx = len(selected_items) - 1 ci_optimal = cis[:idx, selected] di_optimal = math.sqrt(di2s[selected]) elements = kernel_matrix[selected, :] eis = (elements - ci_optimal @ cis[:idx, :]) / di_optimal cis[idx, :] = eis di2s -= np.square(eis) di2s[selected] = -np.inf selected = np.argmax(di2s) selected_items.append(selected) return selected_items è¿™é‡Œå®ç°æ¯”è¾ƒæœ‰è¶£çš„ç‚¹å°±æ˜¯ï¼Œå°½ç®¡ä¼ªä»£ç ä¸­æ˜¯$i \\in \\mathcal{R}$ï¼Œè¿™é‡Œå…¶å®æ˜¯å…¨éƒ¨ç®—äº†ï¼Œä½†ä»–å¯¹å·²é€‰çš„è¿›è¡Œäº†åå¤„ç†ï¼Œç½®ä¹‹ä¸º$-\\infty$\næ¥ä¸‹æ¥æˆ‘ä»¬å®æ“ä¸€ä¸‹ï¼Œä»å¥å­å¯¹åŒ¹é… BQ Corpusï¼ˆBank Question Corpusï¼‰æ‹¿å‡ºä¸€æ¡æ¥çœ‹ä¸€ä¸‹æ•ˆæœï¼Œé¦–å…ˆæ˜¯å°†å…¶ç”¨é¢„è®­ç»ƒæ¨¡å‹è½¬æ¢ä¸ºè¡¨å¾å‘é‡ï¼Œæ¥ç€è¿›è¡Œå½’ä¸€åŒ–æ“ä½œï¼Œä¸ºäº†æ›´å¥½åœ°çœ‹å‡º DPP çš„æ•ˆæœï¼Œæˆ‘ä»¬å…ˆç”¨æœ€å¤§åŒ–å†…ç§¯æ¥å¬å› 50 ä¸ªæ ·æœ¬ï¼Œå†ç”¨ DPP ä»è¿™é‡Œå¬å› 10 ä¸ªå…·æœ‰å¤šæ ·æ€§çš„æ ·æœ¬ï¼š\nåŸå¥ï¼šæˆ‘ç°åœ¨ç”³è¯·å¾®ç²’è´§ï¼Ÿ ['æˆ‘ç°åœ¨ç”³è¯·å¾®ç²’è´§ï¼Ÿ', 'ç”³è¯·å¾®è´·ç²’', 'ç”³è¯·å¾®è´·ç²’', 'æˆ‘æƒ³ç”³è¯·å¾®ç²’è´·', 'å¯ä»¥ä¹ˆæƒ³ç”³è¯·å¾®ç²’è´·', 'å¾®ç²’è²¸ç”³è¯·', 'å¾®ç²’è²¸ç”³è¯·', 'å¦‚ä½•ç”³è¯·å¾®ç²’', 'æˆ‘ç°åœ¨éœ€è¦ç”³è¯·', 'æˆ‘å¯ä»¥ç”³è¯·å¾®ç²’è´·å—', 'æ€ä¹ˆç”³è¯·å¾®ç²’è´§', 'å¾®ç²’è²¸ç”³è¯·', 'å¦‚ä½•ç”³è¯·å¾®ç²’', 'æˆ‘å¯ä»¥ç”³è¯·å¾®ç²’è´·å—', 'ä»€ä¹ˆæƒ…å†µä¸‹æ‰èƒ½ç”³è¯·å¾®ç²’', 'æˆ‘è¦æ±‚ç”³è¯·', 'å¼€é€šå¾®ç²’è´§', 'å¼€é€šå¾®ç²’è²¨', 'å¼€é€šå¾®ç²’è´§', 'å¯ä»¥ç”³è¯·å¼€é€šå—', 'å¼€é€šå¾®ç²’è´§', 'å¼€é€šå¾®ç²’è´§', 'æ€ä¹ˆç”³è¯·å¾®ç²’è´§', 'ç”³è¯·è´·æ¬¾', 'å¦‚ä½•ç”³è¯·å¾®ç²’è´·', 'æ€ä¹ˆç”³è¯·å¾®ç²’è´§', 'å¼€é€šå¾®ç²’è²¨', 'å¦‚ä½•ç”³è¯·å¾®ç²’', 'æƒ³åŠç†å¾®ç²’è´·ä¸šåŠ¡', 'ç”³è¯·è´·æ¬¾', 'å¯ä»¥ç”³è¯·å¼€é€šå—', 'æˆ‘è¦å¾®ç²’è´·', 'æˆ‘è¦å¾®ç²’è´·', 'å¯ä»¥ä¹ˆæƒ³ç”³è¯·å¾®ç²’è´·', 'å¼€é€šå¾®ç±³ç²’', 'æƒ³å¼€é€š', 'æˆ‘è¦å¾®ç²’è´·', 'å¦‚ä½•ç”³è¯·å¾®ç²’', 'æƒ³å¼€é€š', 'å¼€é€šå¾®ç²’è²¨', 'å¼€é€šç²’å¾®è´·', 'ä½•æ—¶æ‰èƒ½ç”³è¯·å•Š', 'ç°åœ¨æƒ³è·å–èµ„æ ¼', 'æ€ä¹ˆç”³è¯·å¾®ç²’è´§', 'å¼€é€šç”³è¯·', 'å¼€é€š', 'å¼€é€š', 'ä½ å¥½æˆ‘ç”³è¯·å€Ÿæ¬¾', 'å¼€é€šå¾®'] å¯ä»¥çœ‹åˆ°æœ‰ä¸å°‘é‡å¤ä¸”æ„æ€ä¸€æ ·çš„æ ·æœ¬ï¼š\næ¥ç€çœ‹ DPP çš„æ•ˆæœï¼š\n['æˆ‘ç°åœ¨ç”³è¯·å¾®ç²’è´§ï¼Ÿ', 'å¼€é€š', 'ä½•æ—¶æ‰èƒ½ç”³è¯·å•Š', 'æ€ä¹ˆç”³è¯·å¾®ç²’è´§', 'ä½ å¥½æˆ‘ç”³è¯·å€Ÿæ¬¾', 'ç°åœ¨æƒ³è·å–èµ„æ ¼', 'æˆ‘å¯ä»¥ç”³è¯·å¾®ç²’è´·å—', 'æˆ‘è¦å¾®ç²’è´·', 'å¾®ç²’è²¸ç”³è¯·', 'ä»€ä¹ˆæƒ…å†µä¸‹æ‰èƒ½ç”³è¯·å¾®ç²’'] å¯ä»¥å‘ç°é‡Œé¢æ²¡æœ‰é‡å¤çš„æƒ…å†µï¼Œè€Œä¸”è¯­ä¹‰å…·å¤‡å¤šæ ·æ€§ï¼Œè€Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ­¤æ—¶å°±æœ‰ä¸€äº›å’Œæˆ‘ä»¬çš„åŸå¥æ„æ€ä¸åŒ¹é…çš„æƒ…å†µï¼Œåœ¨åº”ç”¨æ—¶å¯ä»¥è‡ªå®šä¹‰æ–°çš„ kernelï¼Œè®©å®ƒåŒæ—¶æ³¨æ„ç›¸ä¼¼æ€§å’Œå¤šæ ·æ€§ï¼›æˆ–è€…å¯ä»¥å¯¹ DPP çš„æ ·æœ¬è¿›è¡Œåå¤„ç†ç­‰\nSliding Window å½“$|\\mathcal{S}|$ç›¸å½“å¤§çš„æ—¶å€™ï¼Œå°±ä¼šæœ‰ç›¸ä¼¼çš„æ ·æœ¬å¼€å§‹å‡ºç°ï¼Œå³è¶…å¹³è¡Œä½“ä¼šå¼€å§‹åç¼©ï¼Œä¸å¦¨æˆ‘ä»¬å°†$\\mathcal{S}$ç¼©å°æˆä¸€ä¸ªæ»‘åŠ¨çª—å£$\\mathcal{W}$ï¼Œæˆ‘ä»¬ä»…ä»…éœ€è¦ä¿è¯çª—å£å†…çš„æ ·æœ¬å…·å¤‡å¤šæ ·æ€§å³å¯ï¼Œå³ï¼š\n$$ j = \\mathop{\\arg \\max}_{i \\in \\mathcal{R}} \\log \\det(\\mathbf{L}_{\\mathcal{W} \\cup \\{ i \\}}) - \\log \\det(\\mathbf{L}_{\\mathcal{W}}) $$\næ¨èç³»ç»Ÿä¸­æœ‰çŸ­åºæ¨èï¼ˆShort Sequence Recommendationï¼‰çš„è¯´æ³•ï¼Œæ¨èçš„æ—¶å€™åªè€ƒè™‘ç”¨æˆ·çŸ­æœŸå†…çš„ä¸€äº›è¡Œä¸ºï¼Œè€Œé•¿åºæ¨èä¼šè€ƒè™‘ä¸€ä¸ªè¾ƒé•¿æ—¶é—´è·¨åº¦æ¥è¿›è¡Œæ¨è\nWindow size çš„é€‰æ‹©ä¹Ÿæ˜¯æ¯”è¾ƒé‡è¦çš„ï¼Œä¸å¦¨çœ‹ä¸€äº› demoï¼š\nçª—å£ #ä¸åŒæ ·æœ¬ #é‡å¤æ ·æœ¬ 2 2 0 3 2 1 4 1 2 5 1 1 7 1 0 9 0 0 å¦‚æœæˆ‘ä»¬çš„ç›®çš„æ˜¯ä¸ºäº†é€šè¿‡ Sliding Window è·å–ä¸ç›´æ¥ DPP å¬å›ä¸ä¸€æ ·çš„ç»“æœï¼Œçª—å£çš„å¤§å°è¦é€‚å½“åœ°å°ä¸€äº›ï¼Œç„¶è€Œå°äº†å¯¼è‡´çœ‹çš„èŒƒå›´å°äº†ï¼Œå¾ˆæœ‰å¯èƒ½æœ€åç»“æœå‡ºç°é‡å¤çš„æƒ…å†µï¼Œæœ€å¥½æ˜¯å°†çª—å£è®¾ç½®åˆ°å¬å›æ ·æœ¬æ•°ç›®çš„$20\\% \\sim 30\\%$\nåŒæ—¶ï¼Œä¸ºäº†é˜²æ­¢æ ·æœ¬é‡å¤ï¼Œå¯ä»¥å¤šå¬å›ä¸€äº›ï¼Œæ¯”è¾ƒç›´è§‰çš„åšæ³•å¯ä»¥å†åŠ ä¸Šä¸€ä¸ª window çš„å¤§å°ï¼Œç„¶åå»é‡ï¼š\nw/o window ['å¼€é€š', 'æ€ä¹ˆç”³è¯·å¾®ç²’è´§', 'ä½•æ—¶æ‰èƒ½ç”³è¯·å•Š', 'ç°åœ¨æƒ³è·å–èµ„æ ¼', 'æˆ‘è¦å¾®ç²’è´·', 'å¾®ç²’è²¸ç”³è¯·', 'æˆ‘å¯ä»¥ç”³è¯·å¾®ç²’è´·å—', 'ä»€ä¹ˆæƒ…å†µä¸‹æ‰èƒ½ç”³è¯·å¾®ç²’', 'ä½ å¥½æˆ‘ç”³è¯·å€Ÿæ¬¾', 'æˆ‘ç°åœ¨ç”³è¯·å¾®ç²’è´§ï¼Ÿ'] w/ window ['å¼€é€š', 'å¼€é€šç”³è¯·', 'æ€ä¹ˆç”³è¯·å¾®ç²’è´§', 'ä½•æ—¶æ‰èƒ½ç”³è¯·å•Š', 'ç°åœ¨æƒ³è·å–èµ„æ ¼', 'æˆ‘è¦å¾®ç²’è´·', 'æˆ‘å¯ä»¥ç”³è¯·å¾®ç²’è´·å—', 'å¯ä»¥ç”³è¯·å¼€é€šå—', 'å¦‚ä½•ç”³è¯·å¾®ç²’', 'æˆ‘ç°åœ¨ç”³è¯·å¾®ç²’è´§ï¼Ÿ'] å¯ä»¥çœ‹åˆ°ä¼šæœ‰ 3 ä¸ªä¸ä¸€æ ·çš„æ ·æœ¬ï¼Œè¿˜æ˜¯æ¯”è¾ƒæœ‰æ•ˆçš„\n","wordCount":"4188","inLanguage":"en","datePublished":"2023-05-16T10:20:00+08:00","dateModified":"2023-05-16T10:20:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://yunpengtai.top/posts/fast-greedy-map-inference-for-dpp/"},"publisher":{"@type":"Organization","name":"Tai's Blog","logo":{"@type":"ImageObject","url":"http://yunpengtai.top/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://yunpengtai.top accesskey=h title="Home (Alt + H)">Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://yunpengtai.top/archives/ title=å½’æ¡£><span>å½’æ¡£</span></a></li><li><a href=http://yunpengtai.top/search/ title="æœç´¢ (Alt + /)" accesskey=/><span>æœç´¢</span></a></li><li><a href=http://yunpengtai.top/categories/%E6%8A%98%E8%85%BE title=æŠ˜è…¾><span>æŠ˜è…¾</span></a></li><li><a href=http://yunpengtai.top/tags/ title=æ ‡ç­¾><span>æ ‡ç­¾</span></a></li><li><a href=http://yunpengtai.top/friends/ title=å‹äºº><span>å‹äºº</span></a></li><li><a href=http://yunpengtai.top/about/ title=å…³äº><span>å…³äº</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://yunpengtai.top>Home</a>&nbsp;Â»&nbsp;<a href=http://yunpengtai.top/posts/>Posts</a></div><h1 class=post-title>Fast Greedy MAP Inference for DPP</h1><div class=post-meta><span title='2023-05-16 10:20:00 +0800 CST'>May 16, 2023</span>&nbsp;Â·&nbsp;4188 words</div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e9%97%ae%e9%a2%98 aria-label=é—®é¢˜>é—®é¢˜</a></li><li><a href=#%e6%9a%b4%e5%8a%9b%e6%b1%82%e8%a7%a3 aria-label=æš´åŠ›æ±‚è§£>æš´åŠ›æ±‚è§£</a></li><li><a href=#cholesky-%e5%88%86%e8%a7%a3 aria-label="Cholesky åˆ†è§£">Cholesky åˆ†è§£</a></li><li><a href=#%e5%a2%9e%e9%87%8f%e6%9b%b4%e6%96%b0 aria-label=å¢é‡æ›´æ–°>å¢é‡æ›´æ–°</a></li><li><a href=#%e6%b5%81%e7%a8%8b aria-label=æµç¨‹>æµç¨‹</a></li><li><a href=#%e4%bb%a3%e7%a0%81 aria-label=ä»£ç >ä»£ç </a></li><li><a href=#sliding-window aria-label="Sliding Window">Sliding Window</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h2 id=é—®é¢˜>é—®é¢˜<a hidden class=anchor aria-hidden=true href=#é—®é¢˜>#</a></h2><p>å…ˆè§„å®šä¸€äº›æœ¯è¯­ï¼šè®°é€‰ä¸­å…ƒç´ æ„æˆçš„é›†åˆä¸º<code>$\mathcal{S}$</code>ï¼Œæœªé€‰ä¸­æ„æˆçš„å…ƒç´ è®°ä¸º<code>$\mathcal{R}$</code>ï¼Œ<code>$\mathbf{L}$</code>æ˜¯æ ¸çŸ©é˜µï¼ˆæ ¸å‡½æ•°æ˜¯å†…ç§¯ï¼‰ï¼Œ<code>$\mathbf{L_{V}}$</code>æ˜¯ç”±é›†åˆ<code>$S$</code>çš„å…ƒç´ æ„æˆçš„å­çŸ©é˜µ</p><p>åœ¨ <a href=/posts/determinantal_point_process/>Determinatal Point Process</a> ä¸­æˆ‘ä»¬æåˆ°åœ¨å¤§å°ä¸º<code>$n$</code>çš„é›†åˆé‡Œå»æŒ‘é€‰<code>$k$</code>ä¸ªç‰©å“æ„æˆé›†åˆ<code>$S$</code>, ä½¿å¾—<code>$\det(\mathbf{L}_{\mathbf{V}})$</code>æœ€å¤§ä¾¿æ˜¯æˆ‘ä»¬çš„ç›®æ ‡ï¼Œç„¶è€Œï¼Œæ€ä¹ˆå»é‡Œé¢æŒ‘é€‰<code>$\mathbf{V}$</code>å´æ˜¯ NP-Hard é—®é¢˜ï¼Œä¸ºæ­¤ï¼ŒChen et al., 2018 æå‡ºäº†ä¸€ç¯‡æ¯”è¾ƒå·§å¦™çš„è´ªå©ªç®—æ³•ä½œä¸ºè¿‘ä¼¼è§£ï¼Œå¹¶ä¸”æ•´ä¸ªç®—æ³•çš„å¤æ‚ä»…æœ‰<code>$\mathcal{O}(nk^{2})$</code></p><h2 id=æš´åŠ›æ±‚è§£>æš´åŠ›æ±‚è§£<a hidden class=anchor aria-hidden=true href=#æš´åŠ›æ±‚è§£>#</a></h2><p>æˆ‘ä»¬äººä¸ºè§„å®šäº†è¦é€‰æ‹©<code>$k$</code>ä¸ªï¼Œè¿™ç›¸å½“äºæ˜¯ä¸€ç§å‰éªŒåˆ†å¸ƒï¼Œé‚£ä¹ˆ k-DPP å…¶å®å°±æ˜¯æœ€å¤§åŒ–åéªŒæ¦‚ç‡ï¼ˆMAPï¼‰çš„ä¸€ç§ï¼Œæ¯ä¸€æ­¥çš„ç›®æ ‡å°±æ˜¯é€‰æ‹©ä¼šè®©æ–°çŸ©é˜µçš„è¡Œåˆ—å¼å˜å¾—æœ€å¤§çš„å…ƒç´ </p><p><code>$$ j = \mathop{ \arg \max}_{i \in \mathcal{R}} \log \det(\mathbf{L}_{\mathcal{S} \cup \{i\}}) - \log \det(\mathbf{L}_{\mathcal{S}}) $$</code></p><p>å¯¹äºä¸€ä¸ª<code>$n\times n$</code>çš„æ–¹é˜µè€Œè¨€ï¼Œæ±‚å®ƒçš„è¡Œåˆ—å¼éœ€è¦<code>$\mathcal{O}(n^{3})$</code>ï¼ˆæ¯ä¸€è½®æ¶ˆå…ƒçš„å¤æ‚åº¦æ˜¯<code>$\mathcal{O}(n^{2})$</code>ï¼Œè€Œè¦è¿›è¡Œ<code>$n-1$</code>è½®æ¶ˆå…ƒï¼‰</p><p>è¿™é‡Œçš„è¯ï¼Œæ¯æ¬¡è¦å¯¹<code>$\mathcal{R}$</code>æ‰€æœ‰çš„å…ƒç´ æ±‚ä¸€æ¬¡è¡Œåˆ—å¼ï¼Œè€Œè¡Œåˆ—å¼çš„ä¸º<code>$\mathcal{O}(|\mathcal{S}|^{3})$</code>ï¼ŒåŒæ—¶éœ€è¦é€‰<code>$k$</code>ä¸ªï¼Œå¤æ‚åº¦å˜ä¸ºäº†<code>$\mathcal{O}(|\mathcal{S}|^{3} \cdot |\mathcal{R}| \cdot k)$</code>ï¼Œå³ä¸º<code>$\mathcal{O}(nk^{4})$</code>ï¼Œæš´åŠ›æ±‚è§£çš„è¯å¤æ‚åº¦å¾ˆå¤§ï¼Œæ­¤æ—¶åŸä½œè€…ä¾¿æå‡ºäº†åˆ©ç”¨ Cholesky åˆ†è§£çš„æ–¹å¼æ¥è¿›è¡Œæ±‚è§£ï¼Œå·§å¦™åœ°å°†å¤æ‚åº¦é™åˆ°äº†<code>$\mathcal{O}(nk^{2})$</code></p><h2 id=cholesky-åˆ†è§£>Cholesky åˆ†è§£<a hidden class=anchor aria-hidden=true href=#cholesky-åˆ†è§£>#</a></h2><p><code>$\mathbf{L}_{\mathcal{S}}$</code>æ˜¯å¯¹ç§°åŠæ­£å®šçŸ©é˜µï¼Œè¯æ˜å¦‚ä¸‹ï¼š<code>$\forall \boldsymbol{z} \in \mathbb{R}^{n}$</code></p><p><code>$$ \boldsymbol{z}^{\top}\mathbf{L}_{\mathcal{S}}\boldsymbol{z} = \boldsymbol{z}^{\top} \mathbf{V}^{\top}\mathbf{V} \boldsymbol{z} = \|\mathbf{V}\boldsymbol{z}\|_{2}^{2} \geq 0 \quad \blacksquare $$</code></p><p>é‚£ä¹ˆ<code>$\mathbf{L}_{\mathcal{S}}$</code>å­˜åœ¨ Cholesky åˆ†è§£ï¼Œå³<code>$\mathbf{L}_{\mathcal{S}}=\mathbf{U}\mathbf{U}^{\top}$</code>ï¼Œè¿™é‡Œçš„<code>$\mathbf{U}$</code>æ˜¯å¤§å°ä¸º<code>$|\mathcal{S}|\times|\mathcal{S}|$</code>çš„ä¸‹ä¸‰è§’çŸ©é˜µï¼Œ<code>$\mathbf{L}_{\mathcal{S}\cup \{ i \}}$</code>æ¯”<code>$\mathbf{L}_{\mathcal{S}}$</code>å¤šäº†ä¸€è¡Œå’Œä¸€åˆ—ï¼Œå³ä¸ºï¼š</p><p><code>$$ \mathbf{L}_{\mathcal{S}\cup \{ i \}} = \begin{bmatrix} \mathbf{L}_{\mathcal{S} } & \boldsymbol{u}_{i} \\ \boldsymbol{u}_{i}^{\top} & \boldsymbol{u}_{i}^{\top}\boldsymbol{u} \end{bmatrix} $$</code></p><p>è€Œè¿™é‡Œé»˜è®¤æ¯ä¸ªå‘é‡æ˜¯ç»è¿‡å½’ä¸€åŒ–çš„ï¼Œå³<code>$\boldsymbol{u}_{i}^{\top}\boldsymbol{u}=1$</code>ï¼Œé‚£ä¹ˆ<code>$\mathbf{L}_{\mathcal{S}\cup \{ i \}}$</code>çš„ Cholesky åˆ†è§£å³ä¸ºä¸‹å¼ï¼Œå…¶ä¸­<code>$\boldsymbol{c}_{i} \in \mathbb{R}^{1 \times |\mathcal{S}| }, d_{i} \geq 0$</code>ï¼š</p><p><code>$$ \mathbf{L}_{\mathcal{S}\cup \{ i \}} = \begin{bmatrix} \mathbf{U} & \boldsymbol{0} \\ \boldsymbol{c}_{i} & d_{i} \end{bmatrix}\begin{bmatrix} \mathbf{U} & \boldsymbol{0} \\ \boldsymbol{c}_{i} & d_{i} \end{bmatrix}^{\top} $$</code></p><p>ç»“åˆä¸Šé¢ä¸¤å¼ï¼š</p><p><code>$$ \mathbf{L}_{\mathcal{S}\cup \{ i \}} = \begin{bmatrix} \mathbf{L}_{\mathcal{S} } & \boldsymbol{u}_{i} \\ \boldsymbol{u}_{i}^{\top} & \boldsymbol{u}_{i}^{\top}\boldsymbol{u} \end{bmatrix} = \begin{bmatrix} \mathbf{U}\mathbf{U}^{\top} & \mathbf{U}\boldsymbol{c}_{i}^{\top} \\ \boldsymbol{c}_{i}\mathbf{U}^{\top} & \boldsymbol{c}_{i}\boldsymbol{c}_{i}^{\top} + d_{i}^{2} \end{bmatrix} $$</code></p><p>å¯å¾—ï¼š</p><p><code>$$ \boldsymbol{u}_{i} = \mathbf{U}\boldsymbol{c}_{i}^{\top}, 1 = \boldsymbol{c}_{i}\boldsymbol{c}_{i}^{\top} + d_{i}^{2} $$</code></p><p>é‚£ä¹ˆï¼š</p><p><code>$$ \det(\mathbf{L}_{\mathcal{S}\cup \{ i \}}) = \det \bigg(\begin{bmatrix} \mathbf{U} & \boldsymbol{0} \\ \boldsymbol{c}_{i} & d_{i} \end{bmatrix}\begin{bmatrix} \mathbf{U} & \boldsymbol{0} \\ \boldsymbol{c}_{i} & d_{i} \end{bmatrix}^{\top}\bigg) = \det(\mathbf{U}\mathbf{U}^{\top})\cdot d_{i}^{2}= \det(\mathbf{L}_{\mathcal{S}}) \cdot d_{i}^{2} $$</code></p><p>è¿™æ ·æˆ‘ä»¬ä¸€å¼€å§‹çš„ä¼˜åŒ–ç›®æ ‡å°±å¯ä»¥ç®€åŒ–ä¸ºï¼š</p><p><code>$$ j = \mathop{\arg \max}_{i \in \mathcal{R}} \log(d_{i}^{2}) $$</code></p><p>æ¥ä¸‹æ¥ï¼Œå½“æˆ‘ä»¬å¾—åˆ°<code>$d_j$</code>æ—¶ï¼Œä¾¿å¯ä»¥ç®—å‡º<code>$c_{j}$</code>ï¼Œé‚£ä¹ˆæ·»åŠ <code>$j$</code>ä¹‹åçš„æ–°é›†åˆ<code>$\mathcal{S}'$</code>çš„ Cholesky åˆ†è§£ä¾¿å¯ä»¥æ±‚å¾—ï¼š</p><p><code>$$ \mathbf{L}_{\mathcal{S}'} = \begin{bmatrix} \mathbf{U} & \boldsymbol{0} \\ \boldsymbol{c}_{j} & d_{j} \end{bmatrix}\begin{bmatrix} \mathbf{U} & \boldsymbol{0} \\ \boldsymbol{c}_{j} & d_{j} \end{bmatrix}^{\top} $$</code></p><h2 id=å¢é‡æ›´æ–°>å¢é‡æ›´æ–°<a hidden class=anchor aria-hidden=true href=#å¢é‡æ›´æ–°>#</a></h2><p>æ¥ä¸‹æ¥ä¾¿æ˜¯é‡å¤´æˆï¼Œè¿™ä¸€è½®æˆ‘ä»¬å·²ç»å¾—åˆ°äº†æœ€å¥½çš„<code>$d_{j}$</code>äº†ï¼Œä¸‹ä¸€è½®æˆ‘ä»¬æ€ä¹ˆæ±‚å‡ºæœ€å¤§çš„<code>$d_{i}$</code>å‘¢ï¼Ÿ</p><p>å¯ä»¥åˆ©ç”¨ä¹‹å‰æ±‚å‡ºçš„<code>$c_{i}, d_{i}$</code>æ¥è·å–å½“å‰çš„<code>$c_{i}', d_{i}'$</code>ï¼Œè¿™ä¾¿æ˜¯è®ºæ–‡çš„æ ¸å¿ƒï¼šå¢é‡æ›´æ–°</p><p>åœ¨æˆ‘ä»¬é€‰æ‹©äº†<code>$j$</code>åï¼Œ<code>$c_{i}$</code>å¤šäº†ä¸€ä¸ªå…ƒç´ ï¼Œä¸å¦¨è®°<code>$\boldsymbol{c}_{i}' = [\boldsymbol{c}_{i}, {e}_{i}]$</code>ï¼Œå›å¿†ä¸Šé¢çš„å¼å­ï¼š</p><p><code>$$ \mathbf{L}_{\mathcal{S}\cup \{ i \}} = \begin{bmatrix} \mathbf{L}_{\mathcal{S} } & \boldsymbol{u}_{i} \\ \boldsymbol{u}_{i}^{\top} & \boldsymbol{u}_{i}^{\top}\boldsymbol{u} \end{bmatrix} = \begin{bmatrix} \mathbf{U}\mathbf{U}^{\top} & \mathbf{U}\boldsymbol{c}_{i}^{\top} \\ \boldsymbol{c}_{i}\mathbf{U}^{\top} & \boldsymbol{c}_{i}\boldsymbol{c}_{i}^{\top} + d_{i}^{2} \end{bmatrix} $$</code></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶ä¸­<code>$\boldsymbol{u}_{i}$</code>å°±æ˜¯ç¬¬<code>$i$</code>ä¸ªå…ƒç´ ä¸é›†åˆ<code>$\mathcal{S}$</code>å¯¹åº”å‘é‡åšå†…ç§¯çš„ç»“æœ</p><p><code>$$ \boldsymbol{u}_{i} = \mathbf{U}\boldsymbol{c}_{i}^{\top} $$</code></p><p>é‚£ä¹ˆï¼Œç±»æ¯”ä¸€ä¸‹ï¼Œ<code>$\mathbf{U}_{j}$</code>æ˜¯<code>$\mathbf{L}_{\mathcal{S}'}$</code>çš„ Cholesky åˆ†è§£</p><p><code>$$ \underbrace{\begin{bmatrix} \mathbf{U} & \boldsymbol{0} \\ \boldsymbol{c}_{j} & d_{j} \end{bmatrix}}_{\mathbf{U}_{j}} \boldsymbol{c}_{i}'^{\top} = \boldsymbol{u}_{i}' = \begin{bmatrix} \boldsymbol{u}_{i} \\ \mathbf{L}_{ji} \end{bmatrix} $$</code></p><p>ç»§è€Œï¼š</p><p><code>$$ \langle \boldsymbol{c}_{j},\boldsymbol{c} _{i}\rangle + d_{j}e_{i} = \mathbf{L}_{ji} \implies e_{i} = \frac{\mathbf{L}_{ji}-\langle \boldsymbol{c}_{j},\boldsymbol{c}_{i} \rangle }{d_{j}} $$</code></p><p>æ±‚å‡º<code>$e_{i}$</code>ä¹‹åï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥æ±‚å‡º<code>$d_{i}'$</code>ï¼š</p><p><code>$$ d_{i}'^{2} = 1 - \|\boldsymbol{c}_{i}'\|_{2}^{2} =\underbrace{ 1- \|\boldsymbol{c}_{i}\|_{2}^{2} }_{ {\color{#337dff}d_{i}^{2} }} - e_{i}^{2} = d_{i}^{2} - e_{i}^{2} $$</code></p><h2 id=æµç¨‹>æµç¨‹<a hidden class=anchor aria-hidden=true href=#æµç¨‹>#</a></h2><script src=https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css><script src=https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js></script>
<a data-fancybox=gallery href=https://png.yunpengtai.top/2024/11/c49eb805d3b1e13f0a39e6a7540d6a9d.png><figure class=align-center><img loading=lazy src=https://png.yunpengtai.top/2024/11/c49eb805d3b1e13f0a39e6a7540d6a9d.png#center alt=ç®—æ³•æ•´ä½“æµç¨‹ width=580px height=260px><figcaption><p>ç®—æ³•æ•´ä½“æµç¨‹</p></figcaption></figure></a><p>é‚£æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹å¤æ‚åº¦ï¼Œæ¯é€‰ä¸€ä¸ª<code>$j$</code>éœ€è¦è¿›è¡Œ<code>$|\mathcal{R}| \cdot |\mathcal{S}|$</code>æ¬¡æ“ä½œï¼Œè€Œ<code>$|\mathcal{R}|\leq n, |\mathcal{S}| \leq k$</code>ï¼Œä¹Ÿå°±æ˜¯<code>$\mathcal{O}(nk)$</code>ï¼Œå¾—è¿›è¡Œ<code>$k$</code>æ¬¡è¿­ä»£ï¼Œé‚£ä¹ˆæ€»çš„å¤æ‚åº¦å³ä¸º<code>$\mathcal{O}(nk^{2})$</code>ï¼Œç”±<code>$\mathcal{O}(nk^{4})$</code>é™åˆ°<code>$\mathcal{O}(nk^{2})$</code>ï¼Œæ˜¯ä¸é”™çš„è¿›æ­¥</p><h2 id=ä»£ç >ä»£ç <a hidden class=anchor aria-hidden=true href=#ä»£ç >#</a></h2><p>ç†Ÿæ‚‰äº†æ•´ä¸ªæµç¨‹ä¹‹åï¼Œä»£ç æƒ³å¿…ä¹Ÿæ˜¯å‘¼ä¹‹æ¬²å‡ºäº†</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>math</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>fast_map_dpp</span><span class=p>(</span><span class=n>kernel_matrix</span><span class=p>,</span> <span class=n>max_length</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>cis</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>((</span><span class=n>max_length</span><span class=p>,</span> <span class=n>kernel_matrix</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]))</span>
</span></span><span class=line><span class=cl>    <span class=n>di2s</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>copy</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>diag</span><span class=p>(</span><span class=n>kernel_matrix</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>selected</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>di2s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>selected_items</span> <span class=o>=</span> <span class=p>[</span><span class=n>selected</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=nb>len</span><span class=p>(</span><span class=n>selected_items</span><span class=p>)</span> <span class=o>&lt;</span> <span class=n>max_length</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>idx</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>selected_items</span><span class=p>)</span> <span class=o>-</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>ci_optimal</span> <span class=o>=</span> <span class=n>cis</span><span class=p>[:</span><span class=n>idx</span><span class=p>,</span> <span class=n>selected</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>di_optimal</span> <span class=o>=</span> <span class=n>math</span><span class=o>.</span><span class=n>sqrt</span><span class=p>(</span><span class=n>di2s</span><span class=p>[</span><span class=n>selected</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>elements</span> <span class=o>=</span> <span class=n>kernel_matrix</span><span class=p>[</span><span class=n>selected</span><span class=p>,</span> <span class=p>:]</span>
</span></span><span class=line><span class=cl>        <span class=n>eis</span> <span class=o>=</span> <span class=p>(</span><span class=n>elements</span> <span class=o>-</span> <span class=n>ci_optimal</span> <span class=o>@</span> <span class=n>cis</span><span class=p>[:</span><span class=n>idx</span><span class=p>,</span> <span class=p>:])</span> <span class=o>/</span> <span class=n>di_optimal</span>
</span></span><span class=line><span class=cl>        <span class=n>cis</span><span class=p>[</span><span class=n>idx</span><span class=p>,</span> <span class=p>:]</span> <span class=o>=</span> <span class=n>eis</span>
</span></span><span class=line><span class=cl>        <span class=n>di2s</span> <span class=o>-=</span> <span class=n>np</span><span class=o>.</span><span class=n>square</span><span class=p>(</span><span class=n>eis</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>di2s</span><span class=p>[</span><span class=n>selected</span><span class=p>]</span> <span class=o>=</span> <span class=o>-</span><span class=n>np</span><span class=o>.</span><span class=n>inf</span>
</span></span><span class=line><span class=cl>        <span class=n>selected</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>di2s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>selected_items</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>selected</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>selected_items</span>
</span></span></code></pre></div><p>è¿™é‡Œå®ç°æ¯”è¾ƒæœ‰è¶£çš„ç‚¹å°±æ˜¯ï¼Œå°½ç®¡ä¼ªä»£ç ä¸­æ˜¯<code>$i \in \mathcal{R}$</code>ï¼Œè¿™é‡Œå…¶å®æ˜¯å…¨éƒ¨ç®—äº†ï¼Œä½†ä»–å¯¹å·²é€‰çš„è¿›è¡Œäº†åå¤„ç†ï¼Œç½®ä¹‹ä¸º<code>$-\infty$</code></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å®æ“ä¸€ä¸‹ï¼Œä»å¥å­å¯¹åŒ¹é… BQ Corpusï¼ˆBank Question Corpusï¼‰æ‹¿å‡ºä¸€æ¡æ¥çœ‹ä¸€ä¸‹æ•ˆæœï¼Œé¦–å…ˆæ˜¯å°†å…¶ç”¨é¢„è®­ç»ƒæ¨¡å‹è½¬æ¢ä¸ºè¡¨å¾å‘é‡ï¼Œæ¥ç€è¿›è¡Œå½’ä¸€åŒ–æ“ä½œï¼Œä¸ºäº†æ›´å¥½åœ°çœ‹å‡º DPP çš„æ•ˆæœï¼Œæˆ‘ä»¬å…ˆç”¨æœ€å¤§åŒ–å†…ç§¯æ¥å¬å› 50 ä¸ªæ ·æœ¬ï¼Œå†ç”¨ DPP ä»è¿™é‡Œå¬å› 10 ä¸ªå…·æœ‰å¤šæ ·æ€§çš„æ ·æœ¬ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>åŸå¥ï¼šæˆ‘ç°åœ¨ç”³è¯·å¾®ç²’è´§ï¼Ÿ
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[&#39;æˆ‘ç°åœ¨ç”³è¯·å¾®ç²’è´§ï¼Ÿ&#39;, &#39;ç”³è¯·å¾®è´·ç²’&#39;, &#39;ç”³è¯·å¾®è´·ç²’&#39;, &#39;æˆ‘æƒ³ç”³è¯·å¾®ç²’è´·&#39;, &#39;å¯ä»¥ä¹ˆæƒ³ç”³è¯·å¾®ç²’è´·&#39;,
</span></span><span class=line><span class=cl> &#39;å¾®ç²’è²¸ç”³è¯·&#39;, &#39;å¾®ç²’è²¸ç”³è¯·&#39;, &#39;å¦‚ä½•ç”³è¯·å¾®ç²’&#39;, &#39;æˆ‘ç°åœ¨éœ€è¦ç”³è¯·&#39;, &#39;æˆ‘å¯ä»¥ç”³è¯·å¾®ç²’è´·å—&#39;,
</span></span><span class=line><span class=cl> &#39;æ€ä¹ˆç”³è¯·å¾®ç²’è´§&#39;, &#39;å¾®ç²’è²¸ç”³è¯·&#39;, &#39;å¦‚ä½•ç”³è¯·å¾®ç²’&#39;, &#39;æˆ‘å¯ä»¥ç”³è¯·å¾®ç²’è´·å—&#39;, &#39;ä»€ä¹ˆæƒ…å†µä¸‹æ‰èƒ½ç”³è¯·å¾®ç²’&#39;,
</span></span><span class=line><span class=cl> &#39;æˆ‘è¦æ±‚ç”³è¯·&#39;, &#39;å¼€é€šå¾®ç²’è´§&#39;, &#39;å¼€é€šå¾®ç²’è²¨&#39;, &#39;å¼€é€šå¾®ç²’è´§&#39;, &#39;å¯ä»¥ç”³è¯·å¼€é€šå—&#39;, &#39;å¼€é€šå¾®ç²’è´§&#39;,
</span></span><span class=line><span class=cl> &#39;å¼€é€šå¾®ç²’è´§&#39;, &#39;æ€ä¹ˆç”³è¯·å¾®ç²’è´§&#39;, &#39;ç”³è¯·è´·æ¬¾&#39;, &#39;å¦‚ä½•ç”³è¯·å¾®ç²’è´·&#39;, &#39;æ€ä¹ˆç”³è¯·å¾®ç²’è´§&#39;, &#39;å¼€é€šå¾®ç²’è²¨&#39;,
</span></span><span class=line><span class=cl> &#39;å¦‚ä½•ç”³è¯·å¾®ç²’&#39;, &#39;æƒ³åŠç†å¾®ç²’è´·ä¸šåŠ¡&#39;, &#39;ç”³è¯·è´·æ¬¾&#39;, &#39;å¯ä»¥ç”³è¯·å¼€é€šå—&#39;, &#39;æˆ‘è¦å¾®ç²’è´·&#39;, &#39;æˆ‘è¦å¾®ç²’è´·&#39;,
</span></span><span class=line><span class=cl> &#39;å¯ä»¥ä¹ˆæƒ³ç”³è¯·å¾®ç²’è´·&#39;, &#39;å¼€é€šå¾®ç±³ç²’&#39;, &#39;æƒ³å¼€é€š&#39;, &#39;æˆ‘è¦å¾®ç²’è´·&#39;, &#39;å¦‚ä½•ç”³è¯·å¾®ç²’&#39;, &#39;æƒ³å¼€é€š&#39;, &#39;å¼€é€šå¾®ç²’è²¨&#39;,
</span></span><span class=line><span class=cl> &#39;å¼€é€šç²’å¾®è´·&#39;, &#39;ä½•æ—¶æ‰èƒ½ç”³è¯·å•Š&#39;, &#39;ç°åœ¨æƒ³è·å–èµ„æ ¼&#39;, &#39;æ€ä¹ˆç”³è¯·å¾®ç²’è´§&#39;, &#39;å¼€é€šç”³è¯·&#39;, &#39;å¼€é€š&#39;, &#39;å¼€é€š&#39;,
</span></span><span class=line><span class=cl> &#39;ä½ å¥½æˆ‘ç”³è¯·å€Ÿæ¬¾&#39;, &#39;å¼€é€šå¾®&#39;]
</span></span></code></pre></div><p>å¯ä»¥çœ‹åˆ°æœ‰ä¸å°‘é‡å¤ä¸”æ„æ€ä¸€æ ·çš„æ ·æœ¬ï¼š</p><p>æ¥ç€çœ‹ DPP çš„æ•ˆæœï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[&#39;æˆ‘ç°åœ¨ç”³è¯·å¾®ç²’è´§ï¼Ÿ&#39;, &#39;å¼€é€š&#39;, &#39;ä½•æ—¶æ‰èƒ½ç”³è¯·å•Š&#39;, &#39;æ€ä¹ˆç”³è¯·å¾®ç²’è´§&#39;, &#39;ä½ å¥½æˆ‘ç”³è¯·å€Ÿæ¬¾&#39;, 
</span></span><span class=line><span class=cl> &#39;ç°åœ¨æƒ³è·å–èµ„æ ¼&#39;, &#39;æˆ‘å¯ä»¥ç”³è¯·å¾®ç²’è´·å—&#39;, &#39;æˆ‘è¦å¾®ç²’è´·&#39;, &#39;å¾®ç²’è²¸ç”³è¯·&#39;, &#39;ä»€ä¹ˆæƒ…å†µä¸‹æ‰èƒ½ç”³è¯·å¾®ç²’&#39;]
</span></span></code></pre></div><p>å¯ä»¥å‘ç°é‡Œé¢æ²¡æœ‰é‡å¤çš„æƒ…å†µï¼Œè€Œä¸”è¯­ä¹‰å…·å¤‡å¤šæ ·æ€§ï¼Œè€Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ­¤æ—¶å°±æœ‰ä¸€äº›å’Œæˆ‘ä»¬çš„åŸå¥æ„æ€ä¸åŒ¹é…çš„æƒ…å†µï¼Œåœ¨åº”ç”¨æ—¶å¯ä»¥è‡ªå®šä¹‰æ–°çš„ kernelï¼Œè®©å®ƒåŒæ—¶æ³¨æ„ç›¸ä¼¼æ€§å’Œå¤šæ ·æ€§ï¼›æˆ–è€…å¯ä»¥å¯¹ DPP çš„æ ·æœ¬è¿›è¡Œåå¤„ç†ç­‰</p><h2 id=sliding-window>Sliding Window<a hidden class=anchor aria-hidden=true href=#sliding-window>#</a></h2><p>å½“<code>$|\mathcal{S}|$</code>ç›¸å½“å¤§çš„æ—¶å€™ï¼Œå°±ä¼šæœ‰ç›¸ä¼¼çš„æ ·æœ¬å¼€å§‹å‡ºç°ï¼Œå³è¶…å¹³è¡Œä½“ä¼šå¼€å§‹åç¼©ï¼Œä¸å¦¨æˆ‘ä»¬å°†<code>$\mathcal{S}$</code>ç¼©å°æˆä¸€ä¸ªæ»‘åŠ¨çª—å£<code>$\mathcal{W}$</code>ï¼Œæˆ‘ä»¬ä»…ä»…éœ€è¦ä¿è¯çª—å£å†…çš„æ ·æœ¬å…·å¤‡å¤šæ ·æ€§å³å¯ï¼Œå³ï¼š</p><p><code>$$ j = \mathop{\arg \max}_{i \in \mathcal{R}} \log \det(\mathbf{L}_{\mathcal{W} \cup \{ i \}}) - \log \det(\mathbf{L}_{\mathcal{W}}) $$</code></p><p>æ¨èç³»ç»Ÿä¸­æœ‰çŸ­åºæ¨èï¼ˆShort Sequence Recommendationï¼‰çš„è¯´æ³•ï¼Œæ¨èçš„æ—¶å€™åªè€ƒè™‘ç”¨æˆ·çŸ­æœŸå†…çš„ä¸€äº›è¡Œä¸ºï¼Œè€Œé•¿åºæ¨èä¼šè€ƒè™‘ä¸€ä¸ªè¾ƒé•¿æ—¶é—´è·¨åº¦æ¥è¿›è¡Œæ¨è</p><p>Window size çš„é€‰æ‹©ä¹Ÿæ˜¯æ¯”è¾ƒé‡è¦çš„ï¼Œä¸å¦¨çœ‹ä¸€äº› demoï¼š</p><table><thead><tr><th style=text-align:center>çª—å£</th><th style=text-align:center>#ä¸åŒæ ·æœ¬</th><th style=text-align:center>#é‡å¤æ ·æœ¬</th></tr></thead><tbody><tr><td style=text-align:center>2</td><td style=text-align:center>2</td><td style=text-align:center>0</td></tr><tr><td style=text-align:center>3</td><td style=text-align:center>2</td><td style=text-align:center>1</td></tr><tr><td style=text-align:center>4</td><td style=text-align:center>1</td><td style=text-align:center>2</td></tr><tr><td style=text-align:center>5</td><td style=text-align:center>1</td><td style=text-align:center>1</td></tr><tr><td style=text-align:center>7</td><td style=text-align:center>1</td><td style=text-align:center>0</td></tr><tr><td style=text-align:center>9</td><td style=text-align:center>0</td><td style=text-align:center>0</td></tr></tbody></table><p>å¦‚æœæˆ‘ä»¬çš„ç›®çš„æ˜¯ä¸ºäº†é€šè¿‡ Sliding Window è·å–ä¸ç›´æ¥ DPP å¬å›ä¸ä¸€æ ·çš„ç»“æœï¼Œçª—å£çš„å¤§å°è¦é€‚å½“åœ°å°ä¸€äº›ï¼Œç„¶è€Œå°äº†å¯¼è‡´çœ‹çš„èŒƒå›´å°äº†ï¼Œå¾ˆæœ‰å¯èƒ½æœ€åç»“æœå‡ºç°é‡å¤çš„æƒ…å†µï¼Œæœ€å¥½æ˜¯å°†çª—å£è®¾ç½®åˆ°å¬å›æ ·æœ¬æ•°ç›®çš„<code>$20\% \sim 30\%$</code></p><p>åŒæ—¶ï¼Œä¸ºäº†é˜²æ­¢æ ·æœ¬é‡å¤ï¼Œå¯ä»¥å¤šå¬å›ä¸€äº›ï¼Œæ¯”è¾ƒç›´è§‰çš„åšæ³•å¯ä»¥å†åŠ ä¸Šä¸€ä¸ª window çš„å¤§å°ï¼Œç„¶åå»é‡ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>w/o window
</span></span><span class=line><span class=cl>[&#39;å¼€é€š&#39;, &#39;æ€ä¹ˆç”³è¯·å¾®ç²’è´§&#39;, &#39;ä½•æ—¶æ‰èƒ½ç”³è¯·å•Š&#39;, &#39;ç°åœ¨æƒ³è·å–èµ„æ ¼&#39;, &#39;æˆ‘è¦å¾®ç²’è´·&#39;, &#39;å¾®ç²’è²¸ç”³è¯·&#39;, 
</span></span><span class=line><span class=cl> &#39;æˆ‘å¯ä»¥ç”³è¯·å¾®ç²’è´·å—&#39;, &#39;ä»€ä¹ˆæƒ…å†µä¸‹æ‰èƒ½ç”³è¯·å¾®ç²’&#39;, &#39;ä½ å¥½æˆ‘ç”³è¯·å€Ÿæ¬¾&#39;, &#39;æˆ‘ç°åœ¨ç”³è¯·å¾®ç²’è´§ï¼Ÿ&#39;]
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>w/ window
</span></span><span class=line><span class=cl>[&#39;å¼€é€š&#39;, &#39;å¼€é€šç”³è¯·&#39;, &#39;æ€ä¹ˆç”³è¯·å¾®ç²’è´§&#39;, &#39;ä½•æ—¶æ‰èƒ½ç”³è¯·å•Š&#39;, &#39;ç°åœ¨æƒ³è·å–èµ„æ ¼&#39;, &#39;æˆ‘è¦å¾®ç²’è´·&#39;, 
</span></span><span class=line><span class=cl> &#39;æˆ‘å¯ä»¥ç”³è¯·å¾®ç²’è´·å—&#39;, &#39;å¯ä»¥ç”³è¯·å¼€é€šå—&#39;, &#39;å¦‚ä½•ç”³è¯·å¾®ç²’&#39;, &#39;æˆ‘ç°åœ¨ç”³è¯·å¾®ç²’è´§ï¼Ÿ&#39;]
</span></span></code></pre></div><p>å¯ä»¥çœ‹åˆ°ä¼šæœ‰ 3 ä¸ªä¸ä¸€æ ·çš„æ ·æœ¬ï¼Œè¿˜æ˜¯æ¯”è¾ƒæœ‰æ•ˆçš„</p></div><div style="margin-top:2em;padding:1em;border:0 solid;border-radius:10px;background-color:var(--code-bg)"><h3>ğŸ±å¦‚æœæ‚¨æƒ³è¦å¼•ç”¨ï¼Œè¯·è€ƒè™‘å¦‚ä¸‹æ ¼å¼ï¼š</h3><div style=padding-top:.5em>å°è¿é¹. (May. 16, 2023). ã€ŠFast Greedy MAP Inference for DPPã€‹[Blog
post]. Retrieved from http://yunpengtai.top/posts/fast-greedy-map-inference-for-dpp/</div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>@online{blog-c3e55cb6b15f529b543d0cc9c4789fc6,
</span></span><span class=line><span class=cl>        title={Fast Greedy MAP Inference for DPP},
</span></span><span class=line><span class=cl>        author={Yunpeng Tai},
</span></span><span class=line><span class=cl>        year={2023},
</span></span><span class=line><span class=cl>        month={May},
</span></span><span class=line><span class=cl>        note={http://yunpengtai.top/posts/fast-greedy-map-inference-for-dpp/},
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><div style=padding-bottom:.4em>è‡ªç”±è½¬è½½-éå•†ç”¨-éè¡ç”Ÿ-ä¿æŒç½²åï¼ˆ<a href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank>CC BY-NC-SA 4.0ï¼‰</a></div></div><footer class=post-footer><ul class=post-tags><li><a href=http://yunpengtai.top/tags/ml/>ML</a></li></ul><nav class=paginav><a class=prev href=http://yunpengtai.top/posts/noise-contrastive-estimation/><span class=title>Â« Prev</span><br><span>Noise Contrastive Estimation</span></a>
<a class=next href=http://yunpengtai.top/posts/determinantal-point-process/><span class=title>Next Â»</span><br><span>Determinantal Point Process</span></a></nav></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.css integrity=sha384-3UiQGuEI4TTMaFmGIZumfRPtfKQ3trwQE2JgosJxCnGmQpL/lJdjpcHkaaFwHlcI crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js integrity=sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/artalk@2.8.6/dist/Artalk.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/@artalk/plugin-katex@0.2.4/dist/artalk-plugin-katex.min.js></script><div id=Comments></div><script>const artalk=Artalk.init({el:"#Comments",pageKey:"",pageTitle:"Fast Greedy MAP Inference for DPP",server:"https://comment.yunpengtai.top",site:"Tai's Blog",darkMode:"auto",versionCheck:!1});document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?artalk.setDarkMode(!1):artalk.setDarkMode(!0)})</script></article></main><footer class=footer><span>&copy; 2025 <a href=http://yunpengtai.top>Tai's Blog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/sherlcok314159/MyPaperMod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>(function(e,t){var s=document,o="script",n=s.createElement(o),i=s.getElementsByTagName(o)[0];n.src=e,t&&n.addEventListener("load",function(e){t(e)}),i.parentNode.insertBefore(n,i)})("/js/pangu.min.js",function(){pangu.spacingPage()})</script><script>(function(){var e,t,n,s=document.getElementsByTagName("code");for(n=0;n<s.length;){if(t=s[n],t.parentNode.tagName!=="PRE"&&t.childElementCount===0&&(e=t.textContent,/^\$[^$]/.test(e)&&/[^$]\$$/.test(e)&&(e=e.replace(/^\$/,"\\(").replace(/\$$/,"\\)"),t.textContent=e),/^\\\((.|\s)+\\\)$/.test(e)||/^\\\[(.|\s)+\\\]$/.test(e)||/^\$(.|\s)+\$$/.test(e)||/^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(e))){t.outerHTML=t.innerHTML;continue}n++}})()</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>